(()=>{"use strict";var t={221:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DataBase=void 0;const n=o(758),a=o(51);e.DataBase=class{constructor(){this._books=new Array,this._stocks=new Array,this._customers=new Array,this._sales=new Array,this._rents=new Array,this._bookSpecifications=new Array,this._cancelSales=new Array,this._saleCart=new a.SaleCart,this._rentCart=new n.RentCart}get getBooksList(){return this._books}get getStocksList(){return this._stocks}get getCustomersList(){return this._customers}get getSalesList(){return this._sales}get getRents(){return this._rents}get getBookSpecifications(){return this._bookSpecifications}get getCancaledSales(){return this._cancelSales}get getSaleCart(){return this._saleCart}get getRentCart(){return this._rentCart}set setSaleCart(t){this._saleCart=t}set setRentCart(t){this._rentCart=t}}},39:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BookSpecification=void 0,e.BookSpecification=class{constructor(t,e,o,n){this._isbn=t,this._price=e,this._startDate=o,this._endDate=n}get isbn(){return this._isbn}get price(){return this._price}get startDate(){return this._startDate}get endDate(){return this._endDate}set isbn(t){this._isbn=t}set price(t){this._price=t}set startDate(t){this._startDate=t}set endDate(t){this._endDate=t}}},934:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Book=void 0,e.Book=class{constructor(t,e,o,n,a,i){this._name=e,this._author=o,this._isbn=t,this._publishYear=n,this._pages=a,this._bookSpec=i}get isbn(){return this._isbn}get name(){return this._name}get author(){return this._author}get publishYear(){return this._publishYear}get pages(){return this._pages}get bookSpec(){return this._bookSpec}set isbn(t){this._isbn=t}set name(t){this._name=t}set author(t){this._author=t}set publishYear(t){this._publishYear=t}set pages(t){this._pages=t}set bookSpec(t){this._bookSpec=t}}},41:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CancelSale=void 0,e.CancelSale=class{constructor(t,e,o){this._sale=t,this._refund=e,this._canceledDateTime=o}get sale(){return this._sale}get refund(){return this._refund}get canceledDateTime(){return this._canceledDateTime}set sale(t){this._sale=t}set refund(t){this._refund=t}set canceledDateTime(t){this._canceledDateTime=t}}},916:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Customer=void 0,e.Customer=class{constructor(t,e,o,n){this._id=t,this._name=e,this._surName=o,this._phoneNumber=n}get id(){return this._id}get name(){return this._name}get surName(){return this._surName}get phoneNumber(){return this._phoneNumber}set id(t){this._id=t}set name(t){this._name=t}set surName(t){this._surName=t}set phoneNumber(t){this._phoneNumber=t}}},758:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RentCart=void 0,e.RentCart=class{constructor(){this.bookAndQuantityMap=new Map}}},961:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Rent=void 0;const n=o(354);class a extends n.Sale{constructor(t,e,o,n,a,i,r){super(t,e,o,n,a),this._refundDate=i,this._refund=r}get refundDate(){return this._refundDate}get refund(){return this._refund}set refundDate(t){this._refundDate=t}set refund(t){this._refund=t}}e.Rent=a},51:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SaleCart=void 0,e.SaleCart=class{constructor(){this.bookAndQuantityMap=new Map}}},354:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sale=void 0,e.Sale=class{constructor(t,e,o,n,a){this._bookAndQuantityMap=new Map,this._bookAndQuantityMap=t,this._operationDateTime=e,this._customerId=o,this._operationNumber=n,this._total=a}get bookAndQuantityMap(){return this._bookAndQuantityMap}get operationDateTime(){return this._operationDateTime}get customerId(){return this._customerId}get operationNumber(){return this._operationNumber}get total(){return this._total}set bookAndQuantityMap(t){this._bookAndQuantityMap=t}set operationDateTime(t){this._operationDateTime=t}set customerId(t){this._customerId=t}set operationNumber(t){this._operationNumber=t}set total(t){this._total=t}}},72:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Stock=void 0,e.Stock=class{constructor(t,e,o){this._isbn=t,this._quantity=e,this._shelfNumber=o}get isbn(){return this._isbn}get quantity(){return this._quantity}get shelfNumber(){return this._shelfNumber}set isbn(t){this._isbn=t}set quantity(t){this._quantity=t}set shelfNumber(t){this._shelfNumber=t}}},607:function(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.stockService=e.saleService=e.rentService=e.cancelSaleService=e.customerService=e.bookService=void 0;const a=o(221),i=o(934),r=o(39),s=o(41),c=o(916),l=o(354),u=o(72),d=o(946),h=o(609),m=o(709),p=o(148),k=o(478),S=o(214);function b(t,e){const o=document.getElementById(e),n=document.getElementById(t);o&&n&&n.addEventListener("click",(()=>{"none"===o.style.display?o.style.display="block":o.style.display="none"}))}var f;f=new a.DataBase,e.bookService=new d.BookService(f.getBooksList,f.getBookSpecifications),e.customerService=new m.CustomerService(f.getCustomersList),e.cancelSaleService=new h.CancelSaleService(f.getCancaledSales),e.rentService=new p.RentService(f.getRents,f.getRentCart),e.saleService=new k.SaleService(f.getSalesList,f.getSaleCart),e.stockService=new S.StockService(f.getStocksList),console.log("Services intiliazed."),e.customerService.addCustomer(new c.Customer(1,"","","")),e.customerService.addCustomer(new c.Customer(2,"","","")),e.stockService.addStock("123-45","A45-52",10),e.stockService.addStock("123-46","A45-52",10),function(){n(this,void 0,void 0,(function*(){yield e.bookService.initializeDataMock()}))}(),b("addBookMenuItem","addBookSection"),b("showBooksMenuItem","listBooksSection"),b("addCustomerMenuItem","addCustomerSection"),b("addStockMenuItem","addStockSection"),b("saleBookMenuItem","saleBookSection"),b("rentBookMenuItem","rentBookSection"),b("cancelSaleMenuItem","cancelSaleSection");const g=document.getElementById("add-book-form");null!=g&&(g.onsubmit=t=>n(void 0,void 0,void 0,(function*(){t.preventDefault();const o=new FormData(g),n=o.get("bookTitle"),a=o.get("bookAuthor"),s=o.get("bookIsbn"),c=o.get("bookPublishYear"),l=o.get("bookPages"),u=o.get("bookPrice"),d=new Date,h=new Date("Dec 31, 9999 23:59:59"),m=new r.BookSpecification(s,u,d,h),p=new i.Book(s,n,a,c,l,m);return(yield e.bookService.addBookMock(p))?(alert(p.isbn+" numaralı Kitap Ekleme İşlemi Başarı İle Tamamlanmıştır."),g.reset()):alert(p.isbn+" numaralı Kitap Ekleme İşlemi Sırasında Bir Hata oluştu."),!1})));const y=document.getElementById("add-stock-form");y&&(y.onsubmit=t=>n(void 0,void 0,void 0,(function*(){t.preventDefault();const o=new FormData(y),n=o.get("bookIsbnForAddStock"),a=o.get("stockQuantity"),i=o.get("shelfNumber"),r=new u.Stock(n,a,i);return e.bookService.bookList.some((t=>t.isbn==n))?(yield e.stockService.addStockMock(r))&&alert(n+" isbn numaralı kitaptan, "+a+" kadar sisteme stok eklenmiştir."):alert("Stok eklenmeye çalışılan kitap, kayıtlı değildir. Lütfen önce kitap ekleyiniz"),y.reset(),!1})));const v=document.getElementById("add-customer-form");v&&(v.onsubmit=t=>n(void 0,void 0,void 0,(function*(){t.preventDefault();const o=new FormData(v),n=o.get("customerName"),a=o.get("customerSurname"),i=o.get("customerPhoneNumber"),r=new c.Customer(e.customerService.getNewCustomerId(),n,a,i);return yield e.customerService.addCustomerMock(r),alert("Müşteri Ekleme İşlemi Başarı İle Tamamlanmıştır. "),v.reset(),!1})));const _=document.getElementById("sale-book-form");_&&(_.onsubmit=()=>{const t=new FormData(_),o=t.get("isbnForSale"),n=e.bookService.getBook(o),a=parseInt(t.get("customerIdForSale")),i=e.customerService.isValidCustomer(a),r=parseInt(t.get("quantityForSale")),s=e.stockService.getStock(o);try{return n?s?s.quantity>=r?i?e.saleService.addBookToCart(n,r,a):alert(a+" numaralı müşteri kayıtlı değildir."):alert(r+" kadar kitap dükkanda mevcut değildir."):alert(`Dükkanda ${o} numaralı kitabın stoğu mevcut değildir.`):alert(o+" numaralı kitap yoktur."),_.reset(),!1}catch(t){alert(t)}}),document.getElementById("btnSale").addEventListener("click",(()=>{0===e.saleService.saleCart.bookAndQuantityMap.size?alert("Sepette ürün yok. Lütfen önce ürün ekleyiniz"):e.saleService.cartToSale()})),document.getElementById("showBooksMenuItem").addEventListener("click",(()=>{e.bookService.listBooks()}));const C=document.getElementById("cancel-sale-form");C&&(C.onsubmit=t=>n(void 0,void 0,void 0,(function*(){t.preventDefault();let o=new Map;o.set(e.bookService.getBook("123-45"),3);let n=new l.Sale(o,new Date,1,"S021122163045",123);e.saleService.saleList.push(n);const a=new FormData(C).get("saleNumberforCancel");let i=e.saleService.getSale(a);if(i){let t=new s.CancelSale(i,i.total,new Date);(yield e.cancelSaleService.cancelSaleMock(t))?alert(i.operationNumber+" numaralı satış iptal edilmiştir."):alert(i.operationNumber+" numaralı satış iptal edilirken hata meydana geldi.")}else alert(a+" numaralı satış bulunamamıştır. Tekrar deneyiniz.")})));const w=document.getElementById("rent-book-form");w&&(w.onsubmit=()=>{const t=new FormData(w),o=t.get("isbnForRent"),n=e.bookService.getBook(o),a=parseInt(t.get("customerIdForRent")),i=e.customerService.isValidCustomer(a),r=parseInt(t.get("quantityForRent")),s=e.stockService.getStock(o);try{return n?s?s.quantity>=r?i?e.rentService.addBookToCart(n,r,a):alert(a+" numaralı müşteri kayıtlı değildir."):alert(r+" kadar kitap dükkanda mevcut değildir."):alert(`Dükkanda ${o} numaralı kitabın stoğu mevcut değildir.`):alert(o+" numaralı kitap yoktur."),w.reset(),!1}catch(t){alert(t)}}),document.getElementById("btnRent").addEventListener("click",(()=>{0===e.rentService.rentCart.bookAndQuantityMap.size?alert("Sepette ürün yok. Lütfen önce ürün ekleyiniz"):e.rentService.cartToRent()}))},946:function(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BookService=void 0;const a=o(607);e.BookService=class{constructor(t,e){this.bookApi="http://localhost:3002/api/books/",this._bookList=t,this._bookSpecList=e}get bookList(){return this._bookList}set bookList(t){this._bookList=t}get bookSpecList(){return this._bookSpecList}set bookSpecList(t){this._bookSpecList=t}getBook(t){return this.bookList.find((e=>e.isbn===t))}addBook(t){try{this.bookList.push(t),this._bookSpecList.push(t.bookSpec)}catch(t){console.log("Kitap eklenirken bir hata meydana geldi.")}}isValidBook(t){const e=this.getBook(t);return this.bookList.includes(e)}initializeDataMock(){return n(this,void 0,void 0,(function*(){try{const t=yield fetch("http://localhost:3002/api/books",{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`Hata oluştu, hata kodu: ${t.status} `);const e=yield t.json(),o=JSON.parse(JSON.stringify(e,null,4));this.bookList=o}catch(t){console.error(t)}}))}listBooks(){const t=document.getElementById("listBooks");if(t){let e,o;for(;t.lastChild&&t.children.length>1;)t.removeChild(t.lastChild);this.bookList.forEach((n=>{e=document.createElement("div"),e.className="row-list-book",o=document.createElement("div"),o.className="column-list-book",o.textContent=n.isbn.toString(),e.appendChild(o),o=document.createElement("div"),o.className="column-list-book",o.textContent=n.name.toString(),e.appendChild(o),o=document.createElement("div"),o.className="column-list-book",o.textContent=n.author.toString(),e.appendChild(o),o=document.createElement("div"),o.className="column-list-book",o.textContent=a.stockService.getStockQuantity(n.isbn).toString(),e.appendChild(o),o=document.createElement("div"),o.className="column-list-book",o.textContent=n.bookSpec.price.toString()+" ₺",e.appendChild(o),t.appendChild(e)}))}}addBookMock(t){return n(this,void 0,void 0,(function*(){try{const e=yield fetch(this.bookApi,{method:"POST",body:JSON.stringify({isbn:t.isbn,name:t.name,author:t.author,pages:t.pages,publishYear:t.publishYear}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(e.ok){const t=yield e.json();return console.log(t),!0}throw new Error(`Hata oluştu, hata kodu: ${e.status} `)}catch(t){console.log("Hata Oluştu.")}}))}}},609:function(t,e){var o=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.CancelSaleService=void 0,e.CancelSaleService=class{constructor(t){this.cancelSaleApi="http://localhost:3002/api/cancelSale",this._cancelledSalesList=t}get cancelledSalesList(){return this._cancelledSalesList}set cancelledSalesList(t){this._cancelledSalesList=t}cancelSale(t){let e=this.calculateRefund(t);t.refund=e,this.cancelledSalesList.push(t)}calculateRefund(t){let e;return e=this.calculateDiffHours(t.canceledDateTime,t.sale.operationDateTime)>24?.75*t.sale.total:t.sale.total,e}calculateDiffHours(t,e){let o=t.getTime()-e.getTime();return Math.floor(o/1e3/60/60)}cancelSaleMock(t){return o(this,void 0,void 0,(function*(){let e=this.calculateRefund(t);t.refund=e;try{const e=yield fetch(this.cancelSaleApi,{method:"POST",body:JSON.stringify({sale:t.sale,refund:t.refund,canceledDateTime:t.canceledDateTime}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(e.ok){const t=yield e.json();return console.log(t),!0}throw new Error(`Hata oluştu, hata kodu: ${e.status} `)}catch(t){console.log("Hata Oluştu.")}}))}}},709:function(t,e){var o=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.CustomerService=void 0,e.CustomerService=class{constructor(t){this.customerApi="http://localhost:3002/api/customers",this._customerList=t}get customerList(){return this._customerList}set customerList(t){this._customerList=t}addCustomer(t){this.customerList.push(t)}getNewCustomerId(){let t=0;return this.customerList.length>0&&(t=this.customerList.at(this.customerList.length-1).id),t+=1,t}getCustomerInfo(t){return this.customerList.find((e=>e.id===t))||void 0}isValidCustomer(t){return!!this.customerList.some((e=>e.id===t))}addCustomerMock(t){return o(this,void 0,void 0,(function*(){try{const e=yield fetch(this.customerApi,{method:"POST",body:JSON.stringify({id:t.id,name:t.name,surName:t.surName,phoneNumber:t.phoneNumber}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!e.ok)throw new Error(`Hata oluştu, hata kodu: ${e.status} `);const o=yield e.json();console.log(o)}catch(t){console.log("Hata Oluştu.")}}))}}},148:function(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.RentService=void 0;const a=o(607),i=o(961),r=o(758);e.RentService=class{constructor(t,e){this.rentApi="http://localhost:3002/api/rents",this._rentList=t,this.refundPercent=.75,this._rentCart=e}get rentList(){return this._rentList}set rentList(t){this._rentList=t}get rentCart(){return this._rentCart}set rentCart(t){this._rentCart=t}addRent(t){this.rentList.push(t)}calculateTotal(t){t.bookAndQuantityMap;let e=0;for(let o of t.bookAndQuantityMap)e+=o[0].bookSpec.price*o[1];return e}generateRentNumber(t){let e=new Date;return"R"+e.getDay().toString+e.getMonth().toString+e.getFullYear().toString+e.getHours().toString+e.getMinutes().toString+e.getSeconds().toString+t.toString}calculateRefund(t){t.refund=t.total*this.refundPercent}addBookToCart(t,e,o){if(0===this.rentCart.bookAndQuantityMap.size)this.rentCart.customerId=o;else if(this.rentCart.bookAndQuantityMap.size>0&&this.rentCart.customerId!==o)return alert("Farklı müşteriye kitap kiralanmaya çalışılıyor. Lütfen tek müşteri için işlem yapınız"),!1;this.rentCart.bookAndQuantityMap.set(t,e),this.updateRentCart()}updateRentCart(){const t=document.getElementById("rentCart"),e=document.getElementById("totalRentAmountTl");if(t){let o,n,a=0;for(;t.lastChild&&t.children.length>1;)t.removeChild(t.lastChild);e.textContent="";for(let t=0;t<this.rentCart.bookAndQuantityMap.size;t++){o=document.createElement("div"),o.className="rent-cart-row";for(let t of this.rentCart.bookAndQuantityMap.entries())n=document.createElement("div"),n.className="rent-cart-column",n.textContent=this.rentCart.customerId.toString(),o.appendChild(n),n=document.createElement("div"),n.className="rent-cart-column",n.textContent=t[0].name,o.appendChild(n),n=document.createElement("div"),n.className="rent-cart-column",n.textContent=t[1].toString(),o.appendChild(n),n=document.createElement("div"),n.className="rent-cart-column",n.textContent=(t[0].bookSpec.price*t[1]).toString(),o.appendChild(n)}if(o&&e){for(let t of this.rentCart.bookAndQuantityMap)a+=t[0].bookSpec.price*t[1];t.appendChild(o),e.textContent=a.toString()+" TL"}}}cartToRent(){let t=this.rentCart,e=new i.Rent;e.bookAndQuantityMap=t.bookAndQuantityMap,e.customerId=t.customerId,e.operationNumber=this.generateRentNumber(t.customerId),e.operationDateTime=new Date,e.total=this.calculateTotal(e);for(let t of e.bookAndQuantityMap)a.stockService.increaseStock(t[0].isbn,-t[1]);this.rentCart=new r.RentCart,this.updateRentCart(),this.addRentMock(e)}addRentMock(t){return n(this,void 0,void 0,(function*(){try{console.log(t.bookAndQuantityMap);const e=yield fetch(this.rentApi,{method:"POST",body:JSON.stringify({bookAndQuantity:t.bookAndQuantityMap,customerId:t.customerId,operationDateTime:t.operationDateTime,operationNumber:t.operationNumber,total:t.total}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(e.ok){const t=yield e.json();return console.log(t),alert(t.message+" "+t.saleNumber),!0}throw new Error(`Hata oluştu, hata kodu: ${e.status} `)}catch(t){console.log("Hata Oluştu.")}}))}}},478:function(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SaleService=void 0;const a=o(607),i=o(354),r=o(51);e.SaleService=class{constructor(t,e){this.saleApi="http://localhost:3002/api/sales",this._saleList=t,this._saleCart=e}get saleList(){return this._saleList}set saleList(t){this._saleList=t}get saleCart(){return this._saleCart}set saleCart(t){this._saleCart=t}addSale(t){this.saleList.push(t)}calculateTotal(t){let e=0;for(let o of t.bookAndQuantityMap.entries())e+=o[0].bookSpec.price*o[1];return e}generateSaleNumber(t){let e=new Date;return"S"+e.getDay().toString()+e.getMonth().toString()+e.getFullYear().toString()+e.getHours().toString()+e.getMinutes().toString()+e.getSeconds().toString()+t.toString()}getSale(t){return this.saleList.find((e=>e.operationNumber===t))}removeSale(t){let e=this.saleList.indexOf(t);this.saleList.splice(e,1)}addBookToCart(t,e,o){if(0===this.saleCart.bookAndQuantityMap.size)this.saleCart.customerId=o;else if(this.saleCart.bookAndQuantityMap.size>0&&this.saleCart.customerId!==o)return alert("Farklı müşteriye kitap satılmaya çalışılıyor. Lütfen tek müşteri için işlem yapınız"),!1;this.saleCart.bookAndQuantityMap.set(t,e),this.updateSaleCart()}updateSaleCart(){const t=document.getElementById("saleCart"),e=document.getElementById("totalSaleAmountTl");if(t){let o,n,a=0;for(;t.lastChild&&t.children.length>1;)t.removeChild(t.lastChild);e.textContent="";for(let t=0;t<this.saleCart.bookAndQuantityMap.size;t++){o=document.createElement("div"),o.className="sale-cart-row";for(let t of this.saleCart.bookAndQuantityMap.entries())n=document.createElement("div"),n.className="sale-cart-column",n.textContent=this.saleCart.customerId.toString(),o.appendChild(n),n=document.createElement("div"),n.className="sale-cart-column",n.textContent=t[0].name,o.appendChild(n),n=document.createElement("div"),n.className="sale-cart-column",n.textContent=t[1].toString(),o.appendChild(n),n=document.createElement("div"),n.className="sale-cart-column",n.textContent=(t[0].bookSpec.price*t[1]).toString(),o.appendChild(n)}if(o&&e){for(let t of this.saleCart.bookAndQuantityMap)a+=t[0].bookSpec.price*t[1];t.appendChild(o),e.textContent=a.toString()+" TL"}}}cartToSale(){let t=this.saleCart,e=new i.Sale;e.bookAndQuantityMap=t.bookAndQuantityMap,e.customerId=t.customerId,e.operationNumber=this.generateSaleNumber(t.customerId),e.operationDateTime=new Date,e.total=this.calculateTotal(e);for(let t of e.bookAndQuantityMap)a.stockService.increaseStock(t[0].isbn,-t[1]);this.addSaleMock(e),this.saleCart=new r.SaleCart,this.updateSaleCart()}addSaleMock(t){return n(this,void 0,void 0,(function*(){try{console.log(t.bookAndQuantityMap);const e=yield fetch(this.saleApi,{method:"POST",body:JSON.stringify({bookAndQuantity:t.bookAndQuantityMap,customerId:t.customerId,operationDateTime:t.operationDateTime,operationNumber:t.operationNumber,total:t.total}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!e.ok)throw new Error(`Hata oluştu, hata kodu: ${e.status} `);const o=yield e.json();console.log(o),alert(o.message+" "+o.saleNumber)}catch(t){console.log("Hata Oluştu.")}}))}}},214:function(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,i){function r(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.StockService=void 0;const a=o(72);e.StockService=class{constructor(t){this.stockApi="http://localhost:3002/api/stocks",this._stockList=t}get stockList(){return this._stockList}set stockList(t){this._stockList=t}addStock(t,e,o){try{let n=new a.Stock(t,o,e);return this.stockList.push(n),!0}catch(t){return console.error(t),!1}}increaseStock(t,e){let o=this.getStock(t);return!!o&&(o.quantity=o.quantity+e,!0)}getStock(t){let e=this.stockList.find((e=>e.isbn===t));if(e)return e}getStockQuantity(t){let e=this.getStock(t);return e?e.quantity:0}addStockMock(t){return n(this,void 0,void 0,(function*(){try{const e=yield fetch(this.stockApi,{method:"POST",body:JSON.stringify({isbn:t.isbn,quantity:t.quantity,shelfNumber:t.shelfNumber}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(e.ok){const t=yield e.json();return console.log(t),!0}throw new Error(`Hata oluştu, hata kodu: ${e.status} `)}catch(t){console.log("Hata Oluştu."+t)}}))}increaseStockMock(t){return n(this,void 0,void 0,(function*(){try{const e=yield fetch(this.stockApi+"/"+t.isbn,{method:"PUT",body:JSON.stringify({isbn:t.isbn,quantity:t.quantity,shelfNumber:t.shelfNumber}),headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!e.ok)throw new Error(`Hata oluştu, hata kodu: ${e.status} `);const o=yield e.json();console.log(o),console.log(e.status)}catch(t){console.log("Hata Oluştu.")}}))}}}},e={};!function o(n){var a=e[n];if(void 0!==a)return a.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,o),i.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyaXB0LmpzIiwibWFwcGluZ3MiOiIyR0FLQSxlQUVBLFFBR0EsaUJBWUtBLGNBQ0tDLEtBQUtDLE9BQVMsSUFBSUMsTUFDbEJGLEtBQUtHLFFBQVUsSUFBSUQsTUFDbkJGLEtBQUtJLFdBQWEsSUFBSUYsTUFDdEJGLEtBQUtLLE9BQVMsSUFBSUgsTUFDbEJGLEtBQUtNLE9BQVMsSUFBSUosTUFDbEJGLEtBQUtPLG9CQUFzQixJQUFJTCxNQUMvQkYsS0FBS1EsYUFBZSxJQUFJTixNQUN4QkYsS0FBS1MsVUFBWSxJQUFJLEVBQUFDLFNBQ3JCVixLQUFLVyxVQUFZLElBQUksRUFBQUMsUUFDMUIsQ0FNV0MsbUJBQ04sT0FBT2IsS0FBS0MsTUFDakIsQ0FNV2Esb0JBQ04sT0FBT2QsS0FBS0csT0FDakIsQ0FNV1ksdUJBQ04sT0FBT2YsS0FBS0ksVUFDakIsQ0FNV1ksbUJBQ04sT0FBT2hCLEtBQUtLLE1BQ2pCLENBTVdZLGVBQ04sT0FBT2pCLEtBQUtNLE1BQ2pCLENBTVdZLDRCQUNOLE9BQU9sQixLQUFLTyxtQkFDakIsQ0FNV1ksdUJBQ04sT0FBT25CLEtBQUtRLFlBQ2pCLENBTVdZLGtCQUNOLE9BQU9wQixLQUFLUyxTQUNqQixDQU1PWSxrQkFDVixPQUFPckIsS0FBS1csU0FDYixDQU1XVyxnQkFBWUMsR0FDdEJ2QixLQUFLUyxVQUFZYyxDQUNsQixDQVNXQyxnQkFBWUQsR0FDdEJ2QixLQUFLVyxVQUFZWSxDQUNsQixFLHlGQzNIRCwwQkFNSXhCLFlBQVkwQixFQUFjQyxFQUFlQyxFQUFpQkMsR0FDdEQ1QixLQUFLNkIsTUFBUUosRUFDYnpCLEtBQUs4QixPQUFTSixFQUNkMUIsS0FBSytCLFdBQWFKLEVBQ2xCM0IsS0FBS2dDLFNBQVdKLENBQ3BCLENBT1FILFdBQ1YsT0FBT3pCLEtBQUs2QixLQUNiLENBTVdILFlBQ1YsT0FBTzFCLEtBQUs4QixNQUNiLENBTVdILGdCQUNWLE9BQU8zQixLQUFLK0IsVUFDYixDQU1XSCxjQUNWLE9BQU81QixLQUFLZ0MsUUFDYixDQU1XUCxTQUFLRixHQUNmdkIsS0FBSzZCLE1BQVFOLENBQ2QsQ0FNV0csVUFBTUgsR0FDaEJ2QixLQUFLOEIsT0FBU1AsQ0FDZixDQU1XSSxjQUFVSixHQUNwQnZCLEtBQUsrQixXQUFhUixDQUNuQixDQU1XSyxZQUFRTCxHQUNsQnZCLEtBQUtnQyxTQUFXVCxDQUNqQixFLDZFQzFFRCxhQVFFeEIsWUFBWTBCLEVBQWNRLEVBQWNDLEVBQWdCQyxFQUFxQkMsRUFBZUMsR0FDMUZyQyxLQUFLc0MsTUFBUUwsRUFDYmpDLEtBQUt1QyxRQUFVTCxFQUNmbEMsS0FBSzZCLE1BQVFKLEVBQ2J6QixLQUFLd0MsYUFBZUwsRUFDcEJuQyxLQUFLeUMsT0FBU0wsRUFDZHBDLEtBQUswQyxVQUFZTCxDQUNuQixDQU9VWixXQUNWLE9BQU96QixLQUFLNkIsS0FDYixDQU1XSSxXQUNWLE9BQU9qQyxLQUFLc0MsS0FDYixDQU1XSixhQUNWLE9BQU9sQyxLQUFLdUMsT0FDYixDQU1XSixrQkFDVixPQUFPbkMsS0FBS3dDLFlBQ2IsQ0FNV0osWUFDVixPQUFPcEMsS0FBS3lDLE1BQ2IsQ0FNV0osZUFDVixPQUFPckMsS0FBSzBDLFNBQ2IsQ0FNV2pCLFNBQUtGLEdBQ2Z2QixLQUFLNkIsTUFBUU4sQ0FDZCxDQU1XVSxTQUFLVixHQUNmdkIsS0FBS3NDLE1BQVFmLENBQ2QsQ0FNV1csV0FBT1gsR0FDakJ2QixLQUFLdUMsUUFBVWhCLENBQ2hCLENBTVdZLGdCQUFZWixHQUN0QnZCLEtBQUt3QyxhQUFlakIsQ0FDckIsQ0FNV2EsVUFBTWIsR0FDaEJ2QixLQUFLeUMsT0FBU2xCLENBQ2YsQ0FNV2MsYUFBU2QsR0FDbkJ2QixLQUFLMEMsVUFBWW5CLENBQ2xCLEUsa0ZDaEhELG1CQUtJeEIsWUFBWTRDLEVBQVlDLEVBQWdCQyxHQUNwQzdDLEtBQUs4QyxNQUFRSCxFQUNiM0MsS0FBSytDLFFBQVVILEVBQ2Y1QyxLQUFLZ0Qsa0JBQW9CSCxDQUM3QixDQVNRRixXQUNWLE9BQU8zQyxLQUFLOEMsS0FDYixDQU1XRixhQUNWLE9BQU81QyxLQUFLK0MsT0FDYixDQU1XRix1QkFDVixPQUFPN0MsS0FBS2dELGlCQUNiLENBTVdMLFNBQUtwQixHQUNmdkIsS0FBSzhDLE1BQVF2QixDQUNkLENBTVdxQixXQUFPckIsR0FDakJ2QixLQUFLK0MsUUFBVXhCLENBQ2hCLENBTVdzQixxQkFBaUJ0QixHQUMzQnZCLEtBQUtnRCxrQkFBb0J6QixDQUMxQixFLGlGQzlERCxpQkFNRXhCLFlBQVlrRCxFQUFZaEIsRUFBY2lCLEVBQWlCQyxHQUNyRG5ELEtBQUtvRCxJQUFNSCxFQUNYakQsS0FBS3NDLE1BQVFMLEVBQ2JqQyxLQUFLcUQsU0FBV0gsRUFDaEJsRCxLQUFLc0QsYUFBZUgsQ0FDdEIsQ0FPVUYsU0FDVixPQUFPakQsS0FBS29ELEdBQ2IsQ0FNV25CLFdBQ1YsT0FBT2pDLEtBQUtzQyxLQUNiLENBTVdZLGNBQ1YsT0FBT2xELEtBQUtxRCxRQUNiLENBTVdGLGtCQUNWLE9BQU9uRCxLQUFLc0QsWUFDYixDQU1XTCxPQUFHMUIsR0FDYnZCLEtBQUtvRCxJQUFNN0IsQ0FDWixDQU1XVSxTQUFLVixHQUNmdkIsS0FBS3NDLE1BQVFmLENBQ2QsQ0FNVzJCLFlBQVEzQixHQUNsQnZCLEtBQUtxRCxTQUFXOUIsQ0FDakIsQ0FNVzRCLGdCQUFZNUIsR0FDdEJ2QixLQUFLc0QsYUFBZS9CLENBQ3JCLEUsaUZDMUVELGlCQUlJeEIsY0FDSUMsS0FBS3VELG1CQUFxQixJQUFJQyxHQUNsQyxFLCtFQ1BKLGVBRUEsTUFBYUMsVUFBYSxFQUFBQyxLQUt6QjNELFlBQVl3RCxFQUF3Q0ksRUFBMEJDLEVBQXFCQyxFQUEwQkMsRUFBZUMsRUFBbUJuQixHQUN4Sm9CLE1BQU1ULEVBQW1CSSxFQUFrQkMsRUFBV0MsRUFBZ0JDLEdBRTVFOUQsS0FBS2lFLFlBQWNGLEVBQ25CL0QsS0FBSytDLFFBQVVILENBQ2hCLENBT1dtQixpQkFDVixPQUFPL0QsS0FBS2lFLFdBQ2IsQ0FNV3JCLGFBQ1YsT0FBTzVDLEtBQUsrQyxPQUNiLENBTVdnQixlQUFXeEMsR0FDckJ2QixLQUFLaUUsWUFBYzFDLENBQ3BCLENBTVdxQixXQUFPckIsR0FDakJ2QixLQUFLK0MsUUFBVXhCLENBQ2hCLEVBM0NELFEsZ0ZDREEsaUJBSUl4QixjQUNJQyxLQUFLdUQsbUJBQXFCLElBQUlDLEdBQ2xDLEUsNkVDTkosYUFTSXpELFlBQVl3RCxFQUF3Q0ksRUFBMEJDLEVBQXFCQyxFQUEwQkMsR0FQckgsS0FBQUksb0JBQXVCLElBQUlWLElBUS9CeEQsS0FBS2tFLG9CQUFzQlgsRUFDM0J2RCxLQUFLbUUsbUJBQXFCUixFQUMxQjNELEtBQUtvRSxZQUFjUixFQUNuQjVELEtBQUtxRSxpQkFBbUJSLEVBQ3hCN0QsS0FBS3NFLE9BQVNSLENBQ2xCLENBT1dQLHlCQUNQLE9BQU92RCxLQUFLa0UsbUJBQ2hCLENBT1dQLHdCQUNQLE9BQU8zRCxLQUFLbUUsa0JBQ2hCLENBTVdQLGlCQUNQLE9BQU81RCxLQUFLb0UsV0FDaEIsQ0FNV1Asc0JBQ1AsT0FBTzdELEtBQUtxRSxnQkFDaEIsQ0FNV1AsWUFDUCxPQUFPOUQsS0FBS3NFLE1BQ2hCLENBUVdmLHVCQUFtQmhDLEdBQzFCdkIsS0FBS2tFLG9CQUFzQjNDLENBQy9CLENBTVdvQyxzQkFBa0JwQyxHQUN6QnZCLEtBQUttRSxtQkFBcUI1QyxDQUM5QixDQU1XcUMsZUFBV3JDLEdBQ2xCdkIsS0FBS29FLFlBQWM3QyxDQUN2QixDQU1Xc0Msb0JBQWdCdEMsR0FDdkJ2QixLQUFLcUUsaUJBQW1COUMsQ0FDNUIsQ0FNV3VDLFVBQU12QyxHQUNidkIsS0FBS3NFLE9BQVMvQyxDQUNsQixFLDZFQ3JHSixjQUtJeEIsWUFBWTBCLEVBQWU4QyxFQUFtQkMsR0FDMUN4RSxLQUFLNkIsTUFBUUosRUFDYnpCLEtBQUt5RSxVQUFZRixFQUNqQnZFLEtBQUswRSxhQUFlRixDQUN4QixDQVFXL0MsV0FDUCxPQUFPekIsS0FBSzZCLEtBQ2hCLENBTVcwQyxlQUNQLE9BQU92RSxLQUFLeUUsU0FDaEIsQ0FNV0Qsa0JBQ1AsT0FBT3hFLEtBQUswRSxZQUNoQixDQU1XakQsU0FBS0YsR0FDWnZCLEtBQUs2QixNQUFRTixDQUNqQixDQU1XZ0QsYUFBU2hELEdBQ2hCdkIsS0FBS3lFLFVBQVlsRCxDQUNyQixDQU1XaUQsZ0JBQVlqRCxHQUNuQnZCLEtBQUswRSxhQUFlbkQsQ0FDeEIsRSw2ZUMxREosZUFDQSxTQUNBLFFBQ0EsUUFDQSxTQUNBLFNBQ0EsUUFDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBQ0EsU0FpREEsU0FBU29ELEVBQVlDLEVBQWVDLEdBR2xDLE1BQU1DLEVBQVVDLFNBQVNDLGVBQWVILEdBQ2xDSSxFQUFNRixTQUFTQyxlQUFlSixHQUVoQ0UsR0FBV0csR0FDYkEsRUFBSUMsaUJBQWlCLFNBQVMsS0FDRSxTQUExQkosRUFBUUssTUFBTUMsUUFDaEJOLEVBQVFLLE1BQU1DLFFBQVUsUUFFeEJOLEVBQVFLLE1BQU1DLFFBQVUsTSxHQUloQyxDQWhEQSxJQUE0QkMsSUFQVCxJQUFJLEVBQUFDLFNBUXJCLEVBQUFDLFlBQWMsSUFBSSxFQUFBQyxZQUFZSCxFQUFHeEUsYUFBY3dFLEVBQUduRSx1QkFDbEQsRUFBQXVFLGdCQUFrQixJQUFJLEVBQUFDLGdCQUFnQkwsRUFBR3RFLGtCQUN6QyxFQUFBNEUsa0JBQW9CLElBQUksRUFBQUMsa0JBQWtCUCxFQUFHbEUsa0JBQzdDLEVBQUEwRSxZQUFjLElBQUksRUFBQUMsWUFBWVQsRUFBR3BFLFNBQVVvRSxFQUFHaEUsYUFDOUMsRUFBQTBFLFlBQWMsSUFBSSxFQUFBQyxZQUFZWCxFQUFHckUsYUFBY3FFLEVBQUdqRSxhQUNsRCxFQUFBNkUsYUFBZSxJQUFJLEVBQUFDLGFBQWFiLEVBQUd2RSxlQUNuQ3FGLFFBQVFDLElBQUksd0JBRVosRUFBQVgsZ0JBQWdCWSxZQUFZLElBQUksRUFBQUMsU0FBUyxFQUFHLEdBQUksR0FBSSxLQUNwRCxFQUFBYixnQkFBZ0JZLFlBQVksSUFBSSxFQUFBQyxTQUFTLEVBQUcsR0FBSSxHQUFJLEtBRXBELEVBQUFMLGFBQWFNLFNBQVMsU0FBVSxTQUFVLElBQzFDLEVBQUFOLGFBQWFNLFNBQVMsU0FBVSxTQUFVLElBRzVDLFcsd0NBQ1EsRUFBQWhCLFlBQVlpQixvQkFHcEIsRyxDQXpCQUMsR0E2QkU5QixFQUFZLGtCQUFtQixrQkFDL0JBLEVBQVksb0JBQXFCLG9CQUNqQ0EsRUFBWSxzQkFBdUIsc0JBQ25DQSxFQUFZLG1CQUFvQixtQkFDaENBLEVBQVksbUJBQW9CLG1CQUNoQ0EsRUFBWSxtQkFBb0IsbUJBQ2hDQSxFQUFZLHFCQUFzQixxQkFvQnBDLE1BQU0rQixFQUErQjNCLFNBQVNDLGVBQWUsaUJBQzFDLE1BQWYwQixJQUNGQSxFQUFZQyxTQUFrQkMsR0FBTSxPQUFELDZCQUVqQ0EsRUFBRUMsaUJBQ0YsTUFBTUMsRUFBVyxJQUFJQyxTQUFTTCxHQUV4Qk0sRUFBUUYsRUFBU0csSUFBSSxhQUNyQi9FLEVBQVM0RSxFQUFTRyxJQUFJLGNBQ3RCeEYsRUFBT3FGLEVBQVNHLElBQUksWUFDcEI5RSxFQUFjMkUsRUFBU0csSUFBSSxtQkFDM0I3RSxFQUFRMEUsRUFBU0csSUFBSSxhQUNyQnZGLEVBQVFvRixFQUFTRyxJQUFJLGFBQ3JCdEYsRUFBWSxJQUFJdUYsS0FDaEJ0RixFQUFVLElBQUlzRixLQUFLLHlCQUVuQjdFLEVBQVcsSUFBSSxFQUFBOEUsa0JBQWtCMUYsRUFBTUMsRUFBT0MsRUFBV0MsR0FDekR3RixFQUFPLElBQUksRUFBQUMsS0FBSzVGLEVBQU11RixFQUFPOUUsRUFBUUMsRUFBYUMsRUFBT0MsR0FXL0QsYUFSb0IsRUFBQWtELFlBQVkrQixZQUFZRixLQUUxQ0csTUFBTUgsRUFBSzNGLEtBQU8sNERBQ2xCaUYsRUFBWWMsU0FFWkQsTUFBTUgsRUFBSzNGLEtBQU8sNkRBR2IsQ0FDVCxLQUdGLE1BQU1nRyxFQUFpQzFDLFNBQVNDLGVBQWUsa0JBQzNEeUMsSUFDRkEsRUFBYWQsU0FBa0JDLEdBQU0sT0FBRCw2QkFDbENBLEVBQUVDLGlCQUNGLE1BQU1DLEVBQVcsSUFBSUMsU0FBU1UsR0FFeEJoRyxFQUFPcUYsRUFBU0csSUFBSSx1QkFDcEJTLEVBQVdaLEVBQVNHLElBQUksaUJBQ3hCekMsRUFBY3NDLEVBQVNHLElBQUksZUFFM0JVLEVBQVEsSUFBSSxFQUFBQyxNQUFNbkcsRUFBTWlHLEVBQVVsRCxHQWtCeEMsT0FoQnVCLEVBQUFlLFlBQVlzQyxTQUFTQyxNQUFLQyxHQUFLQSxFQUFFdEcsTUFBUUEsV0FNN0MsRUFBQXdFLGFBQWErQixhQUFhTCxLQUd6Q0osTUFBTTlGLEVBQU8sNEJBQThCaUcsRUFBVyxvQ0FOeERILE1BQU0saUZBWVJFLEVBQWFELFNBQ04sQ0FDVCxLQU1GLE1BQU1TLEVBQW9DbEQsU0FBU0MsZUFBZSxxQkFDOURpRCxJQUNGQSxFQUFnQnRCLFNBQWtCQyxHQUFNLE9BQUQsNkJBQ3JDQSxFQUFFQyxpQkFDRixNQUFNQyxFQUFXLElBQUlDLFNBQVNrQixHQUV4QmhHLEVBQU82RSxFQUFTRyxJQUFJLGdCQUNwQmlCLEVBQVVwQixFQUFTRyxJQUFJLG1CQUN2QjlELEVBQWMyRCxFQUFTRyxJQUFJLHVCQUUzQmtCLEVBQVcsSUFBSSxFQUFBN0IsU0FBUyxFQUFBYixnQkFBZ0IyQyxtQkFBb0JuRyxFQUFNaUcsRUFBUy9FLEdBS2pGLGFBSk0sRUFBQXNDLGdCQUFnQjRDLGdCQUFnQkYsR0FFdENaLE1BQU0scURBQ05VLEVBQWdCVCxTQUNULENBQ1QsS0FNRixNQUFNYyxFQUFpQ3ZELFNBQVNDLGVBQWUsa0JBQzNEc0QsSUFDRkEsRUFBYTNCLFNBQVcsS0FFdEIsTUFBTUcsRUFBVyxJQUFJQyxTQUFTdUIsR0FFeEI3RyxFQUFPcUYsRUFBU0csSUFBSSxlQUNwQkcsRUFBTyxFQUFBN0IsWUFBWWdELFFBQVE5RyxHQUMzQm1DLEVBQWE0RSxTQUFTMUIsRUFBU0csSUFBSSxzQkFDbkN3QixFQUEyQixFQUFBaEQsZ0JBQWdCZ0QsZ0JBQWdCN0UsR0FDM0RXLEVBQVdpRSxTQUFTMUIsRUFBU0csSUFBSSxvQkFFakNVLEVBQVEsRUFBQTFCLGFBQWF5QyxTQUFTakgsR0FFcEMsSUFxQkUsT0FwQkkyRixFQUNFTyxFQUNFQSxFQUFNcEQsVUFBWUEsRUFDaEJrRSxFQUNGLEVBQUExQyxZQUFZNEMsY0FBY3ZCLEVBQU03QyxFQUFVWCxHQUUxQzJELE1BQU0zRCxFQUFhLHVDQUlyQjJELE1BQU1oRCxFQUFXLDBDQUduQmdELE1BQU0sWUFBWTlGLDZDQUdwQjhGLE1BQU05RixFQUFPLDJCQUdmNkcsRUFBYWQsU0FDTixDLENBRVAsTUFBT29CLEdBQ1ByQixNQUFNcUIsRSxJQVd3QjdELFNBQVNDLGVBQWUsV0FDcERFLGlCQUFpQixTQUFTLEtBQ3FCLElBQWpELEVBQUFhLFlBQVk4QyxTQUFTdEYsbUJBQW1CdUYsS0FDMUN2QixNQUFNLGdEQUVOLEVBQUF4QixZQUFZZ0QsWSxJQVEyQmhFLFNBQVNDLGVBQWUscUJBQzlDRSxpQkFBaUIsU0FBUyxLQUM3QyxFQUFBSyxZQUFZeUQsV0FBVyxJQUd6QixNQUFNQyxFQUFrQ2xFLFNBQVNDLGVBQWUsb0JBQzVEaUUsSUFDRkEsRUFBZXRDLFNBQWtCQyxHQUFNLE9BQUQsNkJBQ3BDQSxFQUFFQyxpQkFFRixJQUFJcUMsRUFBSyxJQUFJMUYsSUFDYjBGLEVBQUdDLElBQUksRUFBQTVELFlBQVlnRCxRQUFRLFVBQVcsR0FFdEMsSUFBSWEsRUFBSSxJQUFJLEVBQUExRixLQUFLd0YsRUFBSSxJQUFJaEMsS0FBTSxFQUFHLGdCQUFpQixLQUNuRCxFQUFBbkIsWUFBWXNELFNBQVNDLEtBQUtGLEdBRTFCLE1BQ01HLEVBRFcsSUFBSXhDLFNBQVNrQyxHQUNGaEMsSUFBSSx1QkFFaEMsSUFBSXRFLEVBQU8sRUFBQW9ELFlBQVl5RCxRQUFRRCxHQUUvQixHQUFJNUcsRUFBTSxDQUNSLElBQUk4RyxFQUF5QixJQUFJLEVBQUFDLFdBQVcvRyxFQUFNQSxFQUFLbUIsTUFBTyxJQUFJb0QsYUFDaEQsRUFBQXZCLGtCQUFrQmdFLGVBQWVGLElBR2pEbEMsTUFBTTVFLEVBQUtrQixnQkFBa0IscUNBRTdCMEQsTUFBTTVFLEVBQUtrQixnQkFBa0Isc0QsTUFHL0IwRCxNQUFNZ0MsRUFBYSxvREFHdkIsS0FNRixNQUFNSyxFQUFpQzdFLFNBQVNDLGVBQWUsa0JBQzNENEUsSUFDRkEsRUFBYWpELFNBQVcsS0FFdEIsTUFBTUcsRUFBVyxJQUFJQyxTQUFTNkMsR0FFeEJuSSxFQUFPcUYsRUFBU0csSUFBSSxlQUNwQkcsRUFBTyxFQUFBN0IsWUFBWWdELFFBQVE5RyxHQUMzQm1DLEVBQWE0RSxTQUFTMUIsRUFBU0csSUFBSSxzQkFDbkN3QixFQUEyQixFQUFBaEQsZ0JBQWdCZ0QsZ0JBQWdCN0UsR0FDM0RXLEVBQVdpRSxTQUFTMUIsRUFBU0csSUFBSSxvQkFFakNVLEVBQVEsRUFBQTFCLGFBQWF5QyxTQUFTakgsR0FFcEMsSUFxQkUsT0FwQkkyRixFQUNFTyxFQUNFQSxFQUFNcEQsVUFBWUEsRUFDaEJrRSxFQUNGLEVBQUE1QyxZQUFZOEMsY0FBY3ZCLEVBQU03QyxFQUFVWCxHQUUxQzJELE1BQU0zRCxFQUFhLHVDQUlyQjJELE1BQU1oRCxFQUFXLDBDQUduQmdELE1BQU0sWUFBWTlGLDZDQUdwQjhGLE1BQU05RixFQUFPLDJCQUdmbUksRUFBYXBDLFNBQ04sQyxDQUVQLE1BQU9vQixHQUNQckIsTUFBTXFCLEUsSUFXd0I3RCxTQUFTQyxlQUFlLFdBQ3BERSxpQkFBaUIsU0FBUyxLQUNxQixJQUFqRCxFQUFBVyxZQUFZZ0UsU0FBU3RHLG1CQUFtQnVGLEtBQzFDdkIsTUFBTSxnREFFTixFQUFBMUIsWUFBWWlFLFksK1pDblVoQixlQUlBLG9CQUlJL0osWUFBWThILEVBQXVCa0MsR0FEbkMsS0FBQUMsUUFBa0IsbUNBRWRoSyxLQUFLaUssVUFBWXBDLEVBQ2pCN0gsS0FBS2tLLGNBQWdCSCxDQUN6QixDQU1XbEMsZUFDUCxPQUFPN0gsS0FBS2lLLFNBQ2hCLENBTVdwQyxhQUFTdEcsR0FDaEJ2QixLQUFLaUssVUFBWTFJLENBQ3JCLENBT1d3SSxtQkFDUCxPQUFPL0osS0FBS2tLLGFBQ2hCLENBTVdILGlCQUFheEksR0FDcEJ2QixLQUFLa0ssY0FBZ0IzSSxDQUN6QixDQUdPZ0gsUUFBUTlHLEdBR1gsT0FBT3pCLEtBQUs2SCxTQUFTc0MsTUFBS3BDLEdBQUtBLEVBQUV0RyxPQUFTQSxHQUM5QyxDQUVPMkksUUFBUUMsR0FDWCxJQUNJckssS0FBSzZILFNBQVN5QixLQUFLZSxHQUNuQnJLLEtBQUtrSyxjQUFjWixLQUFLZSxFQUFRaEksUyxDQUNsQyxNQUFPaUksR0FDTG5FLFFBQVFDLElBQUksMkMsQ0FFcEIsQ0FFT21FLFlBQVk5SSxHQUNmLE1BQU1zRyxFQUFJL0gsS0FBS3VJLFFBQVE5RyxHQUN2QixPQUFPekIsS0FBSzZILFNBQVMyQyxTQUFTekMsRUFDbEMsQ0FFTXZCLHFCLHlDQUNGLElBQ0ksTUFBTWlFLFFBQWlCQyxNQUFNLGtDQUFtQyxDQUM1REMsT0FBUSxNQUNSQyxRQUFTLENBQ0xDLE9BQVEsc0JBSWhCLElBQUtKLEVBQVNLLEdBQ1YsTUFBTSxJQUFJQyxNQUFNLDJCQUEyQk4sRUFBU08sV0FFeEQsTUFBTUMsUUFBZ0JSLEVBQVNTLE9BQ3pCQyxFQUFvQkMsS0FBS0MsTUFBTUQsS0FBS0UsVUFBVUwsRUFBUSxLQUFNLElBQ2xFakwsS0FBSzZILFNBQVdzRCxDLENBR2xCLE1BQU92QyxHQUNMekMsUUFBUXlDLE1BQU1BLEUsQ0FFdEIsRyxDQUVPSSxZQUNILE1BQU11QyxFQUFleEcsU0FBU0MsZUFBZSxhQUU3QyxHQUFJdUcsRUFBYyxDQUNkLElBQUlDLEVBQUtDLEVBRVQsS0FBT0YsRUFBYUcsV0FBYUgsRUFBYUksU0FBU0MsT0FBUyxHQUM1REwsRUFBYU0sWUFBWU4sRUFBYUcsV0FHMUMxTCxLQUFLNkgsU0FBU2lFLFNBQVFoSCxJQUNsQjBHLEVBQU16RyxTQUFTZ0gsY0FBYyxPQUM3QlAsRUFBSVEsVUFBWSxnQkFFaEJQLEVBQVMxRyxTQUFTZ0gsY0FBYyxPQUNoQ04sRUFBT08sVUFBWSxtQkFDbkJQLEVBQU9RLFlBQWNuSCxFQUFRckQsS0FBS3lLLFdBQ2xDVixFQUFJVyxZQUFZVixHQUVoQkEsRUFBUzFHLFNBQVNnSCxjQUFjLE9BQ2hDTixFQUFPTyxVQUFZLG1CQUNuQlAsRUFBT1EsWUFBY25ILEVBQVE3QyxLQUFLaUssV0FDbENWLEVBQUlXLFlBQVlWLEdBRWhCQSxFQUFTMUcsU0FBU2dILGNBQWMsT0FDaENOLEVBQU9PLFVBQVksbUJBQ25CUCxFQUFPUSxZQUFjbkgsRUFBUTVDLE9BQU9nSyxXQUNwQ1YsRUFBSVcsWUFBWVYsR0FFaEJBLEVBQVMxRyxTQUFTZ0gsY0FBYyxPQUNoQ04sRUFBT08sVUFBWSxtQkFDbkJQLEVBQU9RLFlBQWMsRUFBQWhHLGFBQWFtRyxpQkFBaUJ0SCxFQUFRckQsTUFBTXlLLFdBQ2pFVixFQUFJVyxZQUFZVixHQUVoQkEsRUFBUzFHLFNBQVNnSCxjQUFjLE9BQ2hDTixFQUFPTyxVQUFZLG1CQUNuQlAsRUFBT1EsWUFBY25ILEVBQVF6QyxTQUFTWCxNQUFNd0ssV0FBYSxLQUN6RFYsRUFBSVcsWUFBWVYsR0FFaEJGLEVBQWFZLFlBQVlYLEVBQUksRyxDQU16QyxDQUVNbEUsWUFBWVMsRyx5Q0FDZCxJQUNJLE1BQU0wQyxRQUFpQkMsTUFBTTFLLEtBQUtnSyxRQUFTLENBQ3ZDVyxPQUFRLE9BQ1IwQixLQUFNakIsS0FBS0UsVUFBVSxDQUNqQjdKLEtBQU1zRyxFQUFFdEcsS0FDUlEsS0FBTThGLEVBQUU5RixLQUNSQyxPQUFRNkYsRUFBRTdGLE9BQ1ZFLE1BQU8yRixFQUFFM0YsTUFDVEQsWUFBYTRGLEVBQUU1RixjQUVuQnlJLFFBQVMsQ0FDTCxlQUFnQixtQkFDaEJDLE9BQVEsc0JBSWhCLEdBQUlKLEVBQVNLLEdBQUksQ0FDYixNQUFNRyxRQUFnQlIsRUFBU1MsT0FFL0IsT0FEQS9FLFFBQVFDLElBQUk2RSxJQUNMLEMsQ0FFUCxNQUFNLElBQUlGLE1BQU0sMkJBQTJCTixFQUFTTyxVLENBTTFELE1BQU9WLEdBQ0xuRSxRQUFRQyxJQUFJLGUsQ0FFcEIsRyxrYUNyS0osMEJBSUlyRyxZQUFZdU0sR0FGWixLQUFBQyxjQUF3Qix1Q0FHcEJ2TSxLQUFLd00sb0JBQXNCRixDQUMvQixDQU1XQSx5QkFDUCxPQUFPdE0sS0FBS3dNLG1CQUNoQixDQU1XRix1QkFBbUIvSyxHQUMxQnZCLEtBQUt3TSxvQkFBc0JqTCxDQUMvQixDQUVPa0ksV0FBV0EsR0FDZCxJQUFJN0csRUFBaUI1QyxLQUFLeU0sZ0JBQWdCaEQsR0FDMUNBLEVBQVc3RyxPQUFTQSxFQUNwQjVDLEtBQUtzTSxtQkFBbUJoRCxLQUFLRyxFQUNqQyxDQUVPZ0QsZ0JBQWdCaEQsR0FDbkIsSUFDSTdHLEVBT0osT0FKSUEsRUFKTzVDLEtBQUswTSxtQkFBbUJqRCxFQUFXNUcsaUJBQWtCNEcsRUFBVzlHLEtBQUtnQixtQkFHckUsR0FDMEIsSUFBeEI4RixFQUFXOUcsS0FBS21CLE1BRWhCMkYsRUFBVzlHLEtBQUttQixNQUV0QmxCLENBQ1gsQ0FFTzhKLG1CQUFtQkMsRUFBVUMsR0FFaEMsSUFBSUMsRUFBcUJGLEVBQUdHLFVBQVlGLEVBQUdFLFVBRTNDLE9BRGVDLEtBQUtDLE1BQU1ILEVBQVksSUFBTyxHQUFLLEdBRXRELENBRU1sRCxlQUFlRixHLHlDQUNqQixJQUFJN0csRUFBaUI1QyxLQUFLeU0sZ0JBQWdCaEQsR0FFMUNBLEVBQVc3RyxPQUFTQSxFQUVwQixJQUNJLE1BQU02SCxRQUFpQkMsTUFBTTFLLEtBQUt1TSxjQUFlLENBQzdDNUIsT0FBUSxPQUNSMEIsS0FBTWpCLEtBQUtFLFVBQVUsQ0FDakIzSSxLQUFNOEcsRUFBVzlHLEtBQ2pCQyxPQUFRNkcsRUFBVzdHLE9BQ25CQyxpQkFBa0I0RyxFQUFXNUcsbUJBRWpDK0gsUUFBUyxDQUNMLGVBQWdCLG1CQUNoQkMsT0FBUSxzQkFNaEIsR0FBSUosRUFBU0ssR0FBSSxDQUNiLE1BQU1HLFFBQWdCUixFQUFTUyxPQUUvQixPQURBL0UsUUFBUUMsSUFBSTZFLElBQ0wsQyxDQUVQLE1BQU0sSUFBSUYsTUFBTSwyQkFBMkJOLEVBQVNPLFUsQ0FLMUQsTUFBT1YsR0FDTG5FLFFBQVFDLElBQUksZSxDQUlwQixHLGdhQ3JGSix3QkFJSXJHLFlBQVlrTixHQUZKLEtBQUFDLFlBQXNCLHNDQUcxQmxOLEtBQUttTixjQUFnQkYsQ0FDekIsQ0FPV0EsbUJBQ1AsT0FBT2pOLEtBQUttTixhQUNoQixDQU1XRixpQkFBYTFMLEdBQ3BCdkIsS0FBS21OLGNBQWdCNUwsQ0FDekIsQ0FHTzhFLFlBQVkrRyxHQUNmcE4sS0FBS2lOLGFBQWEzRCxLQUFLOEQsRUFDM0IsQ0FFT2hGLG1CQUNILElBQUlpRixFQUF5QixFQVM3QixPQVBJck4sS0FBS2lOLGFBQWFyQixPQUFTLElBRTNCeUIsRUFBaUJyTixLQUFLaU4sYUFBYUssR0FBR3ROLEtBQUtpTixhQUFhckIsT0FBUyxHQUFJM0ksSUFHekVvSyxHQUFrQyxFQUUzQkEsQ0FDWCxDQUVPRSxnQkFBZ0J0SyxHQUluQixPQUZlakQsS0FBS2lOLGFBQWE5QyxNQUFLaEMsR0FBWUEsRUFBU2xGLEtBQU9BLFVBSzlELENBRVIsQ0FFT3dGLGdCQUFnQjdFLEdBSW5CLFFBRmM1RCxLQUFLaU4sYUFBYW5GLE1BQUtLLEdBQVlBLEVBQVNsRixLQUFPVyxHQU9yRSxDQUVNeUUsZ0JBQWdCK0UsRyx5Q0FDbEIsSUFDSSxNQUFNM0MsUUFBaUJDLE1BQU0xSyxLQUFLa04sWUFBYSxDQUMzQ3ZDLE9BQVEsT0FDUjBCLEtBQU1qQixLQUFLRSxVQUFVLENBQ2pCckksR0FBSW1LLEVBQVluSyxHQUNoQmhCLEtBQU1tTCxFQUFZbkwsS0FDbEJpQixRQUFTa0ssRUFBWWxLLFFBQ3JCQyxZQUFhaUssRUFBWWpLLGNBRTdCeUgsUUFBUyxDQUNMLGVBQWdCLG1CQUNoQkMsT0FBUSxzQkFJaEIsSUFBS0osRUFBU0ssR0FDVixNQUFNLElBQUlDLE1BQU0sMkJBQTJCTixFQUFTTyxXQUd4RCxNQUFNQyxRQUFnQlIsRUFBU1MsT0FDL0IvRSxRQUFRQyxJQUFJNkUsRSxDQUVkLE1BQU9YLEdBQ0xuRSxRQUFRQyxJQUFJLGUsQ0FFcEIsRyw4WkM5RkosZUFHQSxTQUNBLFNBR0Esb0JBUUlyRyxZQUFZeU4sRUFBdUIzRCxHQUo1QixLQUFBNEQsUUFBVSxrQ0FLYnpOLEtBQUswTixVQUFZRixFQUNqQnhOLEtBQUsyTixjQUFnQixJQUNyQjNOLEtBQUtXLFVBQVlrSixDQUNyQixDQU9XMkQsZUFDUCxPQUFPeE4sS0FBSzBOLFNBQ2hCLENBTVdGLGFBQVNqTSxHQUNoQnZCLEtBQUswTixVQUFZbk0sQ0FDckIsQ0FPV3NJLGVBQ1AsT0FBTzdKLEtBQUtXLFNBQ2hCLENBTVdrSixhQUFTdEksR0FDaEJ2QixLQUFLVyxVQUFZWSxDQUNyQixDQUlPcU0sUUFBUUMsR0FDWDdOLEtBQUt3TixTQUFTbEUsS0FBS3VFLEVBQ3ZCLENBRU9DLGVBQWVELEdBRVdBLEVBQUt0SyxtQkFBbEMsSUFFSXdLLEVBQW1CLEVBR3ZCLElBQUssSUFBSUMsS0FBU0gsRUFBS3RLLG1CQUNuQndLLEdBQVlDLEVBQU0sR0FBRzNMLFNBQVNYLE1BQVFzTSxFQUFNLEdBR2hELE9BQU9ELENBQ1gsQ0FHQUUsbUJBQW1CckssR0FDZixJQUFJc0ssRUFBUSxJQUFJaEgsS0FHaEIsTUFGNEIsSUFBTWdILEVBQU1DLFNBQVNqQyxTQUFXZ0MsRUFBTUUsV0FBV2xDLFNBQVdnQyxFQUFNRyxjQUFjbkMsU0FBV2dDLEVBQU1JLFdBQVdwQyxTQUFXZ0MsRUFBTUssYUFBYXJDLFNBQVdnQyxFQUFNTSxhQUFhdEMsU0FBV3RJLEVBQVdzSSxRQUc5TixDQUVPTyxnQkFBZ0JvQixHQUNuQkEsRUFBS2pMLE9BQVNpTCxFQUFLL0osTUFBUTlELEtBQUsyTixhQUNwQyxDQUVPaEYsY0FBY3ZCLEVBQVk3QyxFQUFrQlgsR0FDL0MsR0FBOEMsSUFBMUM1RCxLQUFLNkosU0FBU3RHLG1CQUFtQnVGLEtBQ2pDOUksS0FBSzZKLFNBQVNqRyxXQUFhQSxPQUN4QixHQUFJNUQsS0FBSzZKLFNBQVN0RyxtQkFBbUJ1RixLQUFPLEdBQzNDOUksS0FBSzZKLFNBQVNqRyxhQUFlQSxFQUU3QixPQURBMkQsTUFBTSwwRkFDQyxFQUlmdkgsS0FBSzZKLFNBQVN0RyxtQkFBbUI0RixJQUFJL0IsRUFBTTdDLEdBQzNDdkUsS0FBS3lPLGdCQUNULENBRU9BLGlCQUNILE1BQU01RSxFQUFXOUUsU0FBU0MsZUFBZSxZQUNuQzBKLEVBQWUzSixTQUFTQyxlQUFlLHFCQUU3QyxHQUFJNkUsRUFBVSxDQUVWLElBQUkyQixFQUFLQyxFQUFRc0MsRUFBbUIsRUFFcEMsS0FBT2xFLEVBQVM2QixXQUFhN0IsRUFBUzhCLFNBQVNDLE9BQVMsR0FDcEQvQixFQUFTZ0MsWUFBWWhDLEVBQVM2QixXQUVsQ2dELEVBQWN6QyxZQUFjLEdBRTVCLElBQUssSUFBSTBDLEVBQVEsRUFBR0EsRUFBUTNPLEtBQUs2SixTQUFTdEcsbUJBQW1CdUYsS0FBTTZGLElBQVMsQ0FFeEVuRCxFQUFNekcsU0FBU2dILGNBQWMsT0FDN0JQLEVBQUlRLFVBQVksZ0JBRWhCLElBQUssSUFBSWdDLEtBQVNoTyxLQUFLNkosU0FBU3RHLG1CQUFtQnFMLFVBRS9DbkQsRUFBUzFHLFNBQVNnSCxjQUFjLE9BQ2hDTixFQUFPTyxVQUFZLG1CQUNuQlAsRUFBT1EsWUFBY2pNLEtBQUs2SixTQUFTakcsV0FBV3NJLFdBQzlDVixFQUFJVyxZQUFZVixHQUVoQkEsRUFBUzFHLFNBQVNnSCxjQUFjLE9BQ2hDTixFQUFPTyxVQUFZLG1CQUNuQlAsRUFBT1EsWUFBYytCLEVBQU0sR0FBRy9MLEtBQzlCdUosRUFBSVcsWUFBWVYsR0FFaEJBLEVBQVMxRyxTQUFTZ0gsY0FBYyxPQUNoQ04sRUFBT08sVUFBWSxtQkFDbkJQLEVBQU9RLFlBQWMrQixFQUFNLEdBQUc5QixXQUM5QlYsRUFBSVcsWUFBWVYsR0FFaEJBLEVBQVMxRyxTQUFTZ0gsY0FBYyxPQUNoQ04sRUFBT08sVUFBWSxtQkFDbkJQLEVBQU9RLGFBQWUrQixFQUFNLEdBQUczTCxTQUFTWCxNQUFRc00sRUFBTSxJQUFJOUIsV0FDMURWLEVBQUlXLFlBQVlWLEUsQ0FJeEIsR0FBSUQsR0FBT2tELEVBQWMsQ0FFckIsSUFBSyxJQUFJRyxLQUFLN08sS0FBSzZKLFNBQVN0RyxtQkFDeEJ3SyxHQUFZYyxFQUFFLEdBQUd4TSxTQUFTWCxNQUFRbU4sRUFBRSxHQUd4Q2hGLEVBQVNzQyxZQUFZWCxHQUNyQmtELEVBQWF6QyxZQUFjOEIsRUFBUzdCLFdBQWEsSyxFQU03RCxDQUVPcEMsYUFDSCxJQUFJRCxFQUFxQjdKLEtBQUs2SixTQUMxQmdFLEVBQU8sSUFBSSxFQUFBcEssS0FFZm9LLEVBQUt0SyxtQkFBcUJzRyxFQUFTdEcsbUJBQ25Dc0ssRUFBS2pLLFdBQWFpRyxFQUFTakcsV0FDM0JpSyxFQUFLaEssZ0JBQWtCN0QsS0FBS2lPLG1CQUFtQnBFLEVBQVNqRyxZQUN4RGlLLEVBQUtsSyxrQkFBb0IsSUFBSXVELEtBQzdCMkcsRUFBSy9KLE1BQVE5RCxLQUFLOE4sZUFBZUQsR0FFakMsSUFBSyxJQUFJaUIsS0FBS2pCLEVBQUt0SyxtQkFDZixFQUFBMEMsYUFBYThJLGNBQWNELEVBQUUsR0FBR3JOLE1BQU9xTixFQUFFLElBSTdDOU8sS0FBSzZKLFNBQVcsSUFBSSxFQUFBakosU0FDcEJaLEtBQUt5TyxpQkFFU3pPLEtBQUtnUCxZQUFZbkIsRUFDbkMsQ0FFTW1CLFlBQVlDLEcseUNBQ2QsSUFDSTlJLFFBQVFDLElBQUk2SSxFQUFFMUwsb0JBRWQsTUFBTWtILFFBQWlCQyxNQUFNMUssS0FBS3lOLFFBQVMsQ0FDdkM5QyxPQUFRLE9BQ1IwQixLQUFNakIsS0FBS0UsVUFBVSxDQUNqQjRELGdCQUFpQkQsRUFBRTFMLG1CQUNuQkssV0FBWXFMLEVBQUVyTCxXQUNkRCxrQkFBbUJzTCxFQUFFdEwsa0JBQ3JCRSxnQkFBaUJvTCxFQUFFcEwsZ0JBQ25CQyxNQUFPbUwsRUFBRW5MLFFBRWI4RyxRQUFTLENBQ0wsZUFBZ0IsbUJBQ2hCQyxPQUFRLHNCQUloQixHQUFJSixFQUFTSyxHQUFJLENBQ2IsTUFBTUcsUUFBZ0JSLEVBQVNTLE9BRy9CLE9BRkEvRSxRQUFRQyxJQUFJNkUsR0FDWjFELE1BQU0wRCxFQUFPa0UsUUFBVSxJQUFNbEUsRUFBTzFCLGFBQzdCLEMsQ0FFUCxNQUFNLElBQUl3QixNQUFNLDJCQUEyQk4sRUFBU08sVSxDQUsxRCxNQUFPVixHQUNMbkUsUUFBUUMsSUFBSSxlLENBRXBCLEcsOFpDcE5KLGVBRUEsU0FDQSxRQUVBLG9CQUtJckcsWUFBWXNKLEVBQXVCUixHQUY1QixLQUFBdUcsUUFBVSxrQ0FHYnBQLEtBQUtxUCxVQUFZaEcsRUFDakJySixLQUFLUyxVQUFZb0ksQ0FDckIsQ0FNV1EsZUFDUCxPQUFPckosS0FBS3FQLFNBQ2hCLENBTVdoRyxhQUFTOUgsR0FDaEJ2QixLQUFLcVAsVUFBWTlOLENBQ3JCLENBTVdzSCxlQUNQLE9BQU83SSxLQUFLUyxTQUNoQixDQU1Xb0ksYUFBU3RILEdBQ2hCdkIsS0FBS1MsVUFBWWMsQ0FDckIsQ0FFTytOLFFBQVEzTSxHQUNYM0MsS0FBS3FKLFNBQVNDLEtBQUszRyxFQUV2QixDQUVBbUwsZUFBZW5MLEdBQ1gsSUFBSW9MLEVBQVcsRUFFZixJQUFLLElBQUlDLEtBQVNyTCxFQUFLWSxtQkFBbUJxTCxVQUN0Q2IsR0FBWUMsRUFBTSxHQUFHM0wsU0FBU1gsTUFBUXNNLEVBQU0sR0FHaEQsT0FBT0QsQ0FDWCxDQUVBd0IsbUJBQW1CM0wsR0FDZixJQUFJc0ssRUFBUSxJQUFJaEgsS0FHaEIsTUFGNEIsSUFBTWdILEVBQU1DLFNBQVNqQyxXQUFhZ0MsRUFBTUUsV0FBV2xDLFdBQWFnQyxFQUFNRyxjQUFjbkMsV0FBYWdDLEVBQU1JLFdBQVdwQyxXQUFhZ0MsRUFBTUssYUFBYXJDLFdBQWFnQyxFQUFNTSxhQUFhdEMsV0FBYXRJLEVBQVdzSSxVQUcxTyxDQUVPMUMsUUFBUUQsR0FFWCxPQURXdkosS0FBS3FKLFNBQVNjLE1BQUtxRixHQUFLQSxFQUFFM0wsa0JBQW9CMEYsR0FFN0QsQ0FFT2tHLFdBQVc5TSxHQUNkLElBQUlnTSxFQUFRM08sS0FBS3FKLFNBQVNxRyxRQUFRL00sR0FDbEMzQyxLQUFLcUosU0FBU3NHLE9BQU9oQixFQUFPLEVBQ2hDLENBRU9oRyxjQUFjdkIsRUFBWTdDLEVBQWtCWCxHQUUvQyxHQUE4QyxJQUExQzVELEtBQUs2SSxTQUFTdEYsbUJBQW1CdUYsS0FDakM5SSxLQUFLNkksU0FBU2pGLFdBQWFBLE9BQ3hCLEdBQUk1RCxLQUFLNkksU0FBU3RGLG1CQUFtQnVGLEtBQU8sR0FDM0M5SSxLQUFLNkksU0FBU2pGLGFBQWVBLEVBRTdCLE9BREEyRCxNQUFNLHdGQUNDLEVBSWZ2SCxLQUFLNkksU0FBU3RGLG1CQUFtQjRGLElBQUkvQixFQUFNN0MsR0FDM0N2RSxLQUFLNFAsZ0JBQ1QsQ0FFT0EsaUJBQ0gsTUFBTS9HLEVBQVc5RCxTQUFTQyxlQUFlLFlBQ25DMEosRUFBZTNKLFNBQVNDLGVBQWUscUJBRTdDLEdBQUk2RCxFQUFVLENBRVYsSUFBSTJDLEVBQUtDLEVBQVFzQyxFQUFtQixFQUVwQyxLQUFPbEYsRUFBUzZDLFdBQWE3QyxFQUFTOEMsU0FBU0MsT0FBUyxHQUNwRC9DLEVBQVNnRCxZQUFZaEQsRUFBUzZDLFdBRWxDZ0QsRUFBY3pDLFlBQWMsR0FFNUIsSUFBSyxJQUFJMEMsRUFBUSxFQUFHQSxFQUFRM08sS0FBSzZJLFNBQVN0RixtQkFBbUJ1RixLQUFNNkYsSUFBUyxDQUV4RW5ELEVBQU16RyxTQUFTZ0gsY0FBYyxPQUM3QlAsRUFBSVEsVUFBWSxnQkFFaEIsSUFBSyxJQUFJZ0MsS0FBU2hPLEtBQUs2SSxTQUFTdEYsbUJBQW1CcUwsVUFFL0NuRCxFQUFTMUcsU0FBU2dILGNBQWMsT0FDaENOLEVBQU9PLFVBQVksbUJBQ25CUCxFQUFPUSxZQUFjak0sS0FBSzZJLFNBQVNqRixXQUFXc0ksV0FDOUNWLEVBQUlXLFlBQVlWLEdBRWhCQSxFQUFTMUcsU0FBU2dILGNBQWMsT0FDaENOLEVBQU9PLFVBQVksbUJBQ25CUCxFQUFPUSxZQUFjK0IsRUFBTSxHQUFHL0wsS0FDOUJ1SixFQUFJVyxZQUFZVixHQUVoQkEsRUFBUzFHLFNBQVNnSCxjQUFjLE9BQ2hDTixFQUFPTyxVQUFZLG1CQUNuQlAsRUFBT1EsWUFBYytCLEVBQU0sR0FBRzlCLFdBQzlCVixFQUFJVyxZQUFZVixHQUVoQkEsRUFBUzFHLFNBQVNnSCxjQUFjLE9BQ2hDTixFQUFPTyxVQUFZLG1CQUNuQlAsRUFBT1EsYUFBZStCLEVBQU0sR0FBRzNMLFNBQVNYLE1BQVFzTSxFQUFNLElBQUk5QixXQUMxRFYsRUFBSVcsWUFBWVYsRSxDQUl4QixHQUFJRCxHQUFPa0QsRUFBYyxDQUVyQixJQUFLLElBQUlHLEtBQUs3TyxLQUFLNkksU0FBU3RGLG1CQUN4QndLLEdBQVljLEVBQUUsR0FBR3hNLFNBQVNYLE1BQVFtTixFQUFFLEdBR3hDaEcsRUFBU3NELFlBQVlYLEdBQ3JCa0QsRUFBYXpDLFlBQWM4QixFQUFTN0IsV0FBYSxLLEVBRzdELENBRU9uRCxhQUNILElBQUlGLEVBQXFCN0ksS0FBSzZJLFNBQzFCbEcsRUFBTyxJQUFJLEVBQUFlLEtBRWZmLEVBQUtZLG1CQUFxQnNGLEVBQVN0RixtQkFDbkNaLEVBQUtpQixXQUFhaUYsRUFBU2pGLFdBQzNCakIsRUFBS2tCLGdCQUFrQjdELEtBQUt1UCxtQkFBbUIxRyxFQUFTakYsWUFDeERqQixFQUFLZ0Isa0JBQW9CLElBQUl1RCxLQUM3QnZFLEVBQUttQixNQUFROUQsS0FBSzhOLGVBQWVuTCxHQUVqQyxJQUFLLElBQUltTSxLQUFLbk0sRUFBS1ksbUJBQ2YsRUFBQTBDLGFBQWE4SSxjQUFjRCxFQUFFLEdBQUdyTixNQUFPcU4sRUFBRSxJQUc3QzlPLEtBQUs2UCxZQUFZbE4sR0FDakIzQyxLQUFLNkksU0FBVyxJQUFJLEVBQUFuSSxTQUNwQlYsS0FBSzRQLGdCQUNULENBRU1DLFlBQVlMLEcseUNBQ2QsSUFDSXJKLFFBQVFDLElBQUlvSixFQUFFak0sb0JBRWQsTUFBTWtILFFBQWlCQyxNQUFNMUssS0FBS29QLFFBQVMsQ0FDdkN6RSxPQUFRLE9BQ1IwQixLQUFNakIsS0FBS0UsVUFBVSxDQUNqQjRELGdCQUFpQk0sRUFBRWpNLG1CQUNuQkssV0FBWTRMLEVBQUU1TCxXQUNkRCxrQkFBbUI2TCxFQUFFN0wsa0JBQ3JCRSxnQkFBaUIyTCxFQUFFM0wsZ0JBQ25CQyxNQUFPMEwsRUFBRTFMLFFBRWI4RyxRQUFTLENBQ0wsZUFBZ0IsbUJBQ2hCQyxPQUFRLHNCQUloQixJQUFLSixFQUFTSyxHQUNWLE1BQU0sSUFBSUMsTUFBTSwyQkFBMkJOLEVBQVNPLFdBR3hELE1BQU1DLFFBQWdCUixFQUFTUyxPQUMvQi9FLFFBQVFDLElBQUk2RSxHQUVaMUQsTUFBTTBELEVBQU9rRSxRQUFVLElBQUtsRSxFQUFPMUIsVyxDQUVyQyxNQUFPZSxHQUNMbkUsUUFBUUMsSUFBSSxlLENBRXBCLEcsK1pDck1KLGNBRUEscUJBSUlyRyxZQUFZK1AsR0FGSixLQUFBQyxTQUFtQixtQ0FHdkIvUCxLQUFLZ1EsV0FBYUYsQ0FDdEIsQ0FNV0EsZ0JBQ1AsT0FBTzlQLEtBQUtnUSxVQUNoQixDQU1XRixjQUFVdk8sR0FDakJ2QixLQUFLZ1EsV0FBYXpPLENBQ3RCLENBVU9nRixTQUFTOUUsRUFBYytDLEVBQXFCRCxHQUMvQyxJQUVJLElBQUkwTCxFQUFXLElBQUksRUFBQXJJLE1BQU1uRyxFQUFNOEMsRUFBVUMsR0FFekMsT0FEQXhFLEtBQUs4UCxVQUFVeEcsS0FBSzJHLElBQ2IsQyxDQUNULE1BQU9ySCxHQUVMLE9BREF6QyxRQUFReUMsTUFBTUEsSUFDUCxDLENBRWYsQ0FRT21HLGNBQWN0TixFQUFjOEMsR0FDL0IsSUFBSW9ELEVBQVEzSCxLQUFLMEksU0FBU2pILEdBQzFCLFFBQUlrRyxJQUNBQSxFQUFNcEQsU0FBWW9ELEVBQU1wRCxTQUFXQSxHQUM1QixFQUlmLENBT09tRSxTQUFTakgsR0FDWixJQUFJa0csRUFBUTNILEtBQUs4UCxVQUFVM0YsTUFBS3FGLEdBQUtBLEVBQUUvTixPQUFTQSxJQUNoRCxHQUFJa0csRUFDQSxPQUFPQSxDQUVmLENBRU95RSxpQkFBaUIzSyxHQUNwQixJQUFJK04sRUFBV3hQLEtBQUswSSxTQUFTakgsR0FFN0IsT0FBSStOLEVBQ09BLEVBQUVqTCxTQUVGLENBRWYsQ0FPTXlELGFBQWF3SCxHLHlDQUNmLElBQ0ksTUFBTS9FLFFBQWlCQyxNQUFNMUssS0FBSytQLFNBQVUsQ0FDeENwRixPQUFRLE9BQ1IwQixLQUFNakIsS0FBS0UsVUFBVSxDQUNqQjdKLEtBQU0rTixFQUFFL04sS0FDUjhDLFNBQVVpTCxFQUFFakwsU0FDWkMsWUFBYWdMLEVBQUVoTCxjQUVuQm9HLFFBQVMsQ0FDTCxlQUFnQixtQkFDaEJDLE9BQVEsc0JBSWhCLEdBQUlKLEVBQVNLLEdBQUksQ0FDYixNQUFNRyxRQUFnQlIsRUFBU1MsT0FFL0IsT0FEQS9FLFFBQVFDLElBQUk2RSxJQUNMLEMsQ0FFUCxNQUFNLElBQUlGLE1BQU0sMkJBQTJCTixFQUFTTyxVLENBRTFELE1BQU9wQyxHQUNMekMsUUFBUUMsSUFBSSxlQUFpQndDLEUsQ0FFckMsRyxDQU1Nc0gsa0JBQWtCVixHLHlDQUNwQixJQUVJLE1BQU0vRSxRQUFpQkMsTUFBTTFLLEtBQUsrUCxTQUFXLElBQU1QLEVBQUUvTixLQUFNLENBQ3ZEa0osT0FBUSxNQUNSMEIsS0FBTWpCLEtBQUtFLFVBQVUsQ0FDakI3SixLQUFNK04sRUFBRS9OLEtBQ1I4QyxTQUFVaUwsRUFBRWpMLFNBQ1pDLFlBQWFnTCxFQUFFaEwsY0FFbkJvRyxRQUFTLENBQ0wsZUFBZ0IsbUJBQ2hCQyxPQUFRLHNCQUloQixJQUFLSixFQUFTSyxHQUNWLE1BQU0sSUFBSUMsTUFBTSwyQkFBMkJOLEVBQVNPLFdBR3hELE1BQU1DLFFBQWdCUixFQUFTUyxPQUMvQi9FLFFBQVFDLElBQUk2RSxHQUNaOUUsUUFBUUMsSUFBSXFFLEVBQVNPLE8sQ0FDdkIsTUFBT1YsR0FDTG5FLFFBQVFDLElBQUksZSxDQUVwQixHLEtDbEpBK0osRUFBMkIsQ0FBQyxHQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhRSxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkUsR0FBWSxDQUdqREcsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JMLEdBQVVNLEtBQUtGLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNKLEdBR3BFSyxFQUFPRCxPQUNmLENDbkIwQkosQ0FBb0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL2RiL2RhdGFiYXNlLnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL2RvbWFpbi9ib29rLXNwZWNpZmljYXRpb24udHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvZG9tYWluL2Jvb2sudHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvZG9tYWluL2NhbmNhbC1zYWxlLnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL2RvbWFpbi9jdXN0b21lci50cyIsIndlYnBhY2s6Ly9yZW50LWEtYm9vay10cy8uL3NyYy9kb21haW4vcmVudC1jYXJ0LnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL2RvbWFpbi9yZW50LnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL2RvbWFpbi9zYWxlLWNhcnQudHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvZG9tYWluL3NhbGUudHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvZG9tYWluL3N0b2NrLnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL3NlcnZpY2UvYm9vay1zZXJ2aWNlLnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzLy4vc3JjL3NlcnZpY2UvY2FuY2FsLXNhbGUtc2VydmljZS50cyIsIndlYnBhY2s6Ly9yZW50LWEtYm9vay10cy8uL3NyYy9zZXJ2aWNlL2N1c3RvbWVyLXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvc2VydmljZS9yZW50LXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvc2VydmljZS9zYWxlLXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vcmVudC1hLWJvb2stdHMvLi9zcmMvc2VydmljZS9zdG9jay1zZXJ2aWNlLnRzIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3JlbnQtYS1ib29rLXRzL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCb29rIH0gZnJvbSBcIi4uL2RvbWFpbi9ib29rXCI7XG5pbXBvcnQgeyBCb29rU3BlY2lmaWNhdGlvbiB9IGZyb20gXCIuLi9kb21haW4vYm9vay1zcGVjaWZpY2F0aW9uXCI7XG5pbXBvcnQgeyBDYW5jZWxTYWxlIH0gZnJvbSBcIi4uL2RvbWFpbi9jYW5jYWwtc2FsZVwiO1xuaW1wb3J0IHsgQ3VzdG9tZXIgfSBmcm9tIFwiLi4vZG9tYWluL2N1c3RvbWVyXCI7XG5pbXBvcnQgeyBSZW50IH0gZnJvbSBcIi4uL2RvbWFpbi9yZW50XCI7XG5pbXBvcnQgeyBSZW50Q2FydCB9IGZyb20gXCIuLi9kb21haW4vcmVudC1jYXJ0XCI7XG5pbXBvcnQgeyBTYWxlIH0gZnJvbSBcIi4uL2RvbWFpbi9zYWxlXCI7XG5pbXBvcnQgeyBTYWxlQ2FydCB9IGZyb20gXCIuLi9kb21haW4vc2FsZS1jYXJ0XCI7XG5pbXBvcnQgeyBTdG9jayB9IGZyb20gXCIuLi9kb21haW4vc3RvY2tcIjtcblxuZXhwb3J0IGNsYXNzIERhdGFCYXNlIHtcblxuICAgICBwcml2YXRlIF9ib29rczogQXJyYXk8Qm9vaz47Ly9cbiAgICAgcHJpdmF0ZSBfc3RvY2tzOiBBcnJheTxTdG9jaz47XG4gICAgIHByaXZhdGUgX2N1c3RvbWVyczogQXJyYXk8Q3VzdG9tZXI+Oy8vXG4gICAgIHByaXZhdGUgX3NhbGVzOiBBcnJheTxTYWxlPjsvL1xuICAgICBwcml2YXRlIF9yZW50czogQXJyYXk8UmVudD47XG4gICAgIHByaXZhdGUgX2Jvb2tTcGVjaWZpY2F0aW9uczogQXJyYXk8Qm9va1NwZWNpZmljYXRpb24+O1xuICAgICBwcml2YXRlIF9jYW5jZWxTYWxlczogQXJyYXk8Q2FuY2VsU2FsZT47Ly9cbiAgICAgcHJpdmF0ZSBfc2FsZUNhcnQ6IFNhbGVDYXJ0O1xuICAgICBwcml2YXRlIF9yZW50Q2FydDpSZW50Q2FydDtcblxuICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICB0aGlzLl9ib29rcyA9IG5ldyBBcnJheTxCb29rPigpO1xuICAgICAgICAgIHRoaXMuX3N0b2NrcyA9IG5ldyBBcnJheTxTdG9jaz4oKTtcbiAgICAgICAgICB0aGlzLl9jdXN0b21lcnMgPSBuZXcgQXJyYXk8Q3VzdG9tZXI+KCk7XG4gICAgICAgICAgdGhpcy5fc2FsZXMgPSBuZXcgQXJyYXk8U2FsZT4oKTtcbiAgICAgICAgICB0aGlzLl9yZW50cyA9IG5ldyBBcnJheTxSZW50PigpO1xuICAgICAgICAgIHRoaXMuX2Jvb2tTcGVjaWZpY2F0aW9ucyA9IG5ldyBBcnJheTxCb29rU3BlY2lmaWNhdGlvbj4oKTtcbiAgICAgICAgICB0aGlzLl9jYW5jZWxTYWxlcyA9IG5ldyBBcnJheTxDYW5jZWxTYWxlPigpO1xuICAgICAgICAgIHRoaXMuX3NhbGVDYXJ0ID0gbmV3IFNhbGVDYXJ0O1xuICAgICAgICAgIHRoaXMuX3JlbnRDYXJ0ID0gbmV3IFJlbnRDYXJ0O1xuICAgICB9XG5cbiAgICAgLyoqXG4gICAgICAqIEdldHRlciBib29rc1xuICAgICAgKiBAcmV0dXJuIHtBcnJheTxCb29rPn1cbiAgICAgICovXG4gICAgIHB1YmxpYyBnZXQgZ2V0Qm9va3NMaXN0KCk6IEFycmF5PEJvb2s+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYm9va3M7XG4gICAgIH1cblxuICAgICAvKipcbiAgICAgICogR2V0dGVyIHN0b2Nrc1xuICAgICAgKiBAcmV0dXJuIHtBcnJheTxTdG9jaz59XG4gICAgICAqL1xuICAgICBwdWJsaWMgZ2V0IGdldFN0b2Nrc0xpc3QoKTogQXJyYXk8U3RvY2s+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fc3RvY2tzO1xuICAgICB9XG5cbiAgICAgLyoqXG4gICAgICAqIEdldHRlciBjdXN0b21lcnNcbiAgICAgICogQHJldHVybiB7QXJyYXk8Q3VzdG9tZXI+fVxuICAgICAgKi9cbiAgICAgcHVibGljIGdldCBnZXRDdXN0b21lcnNMaXN0KCk6IEFycmF5PEN1c3RvbWVyPiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbWVycztcbiAgICAgfVxuXG4gICAgIC8qKlxuICAgICAgKiBHZXR0ZXIgc2FsZXNcbiAgICAgICogQHJldHVybiB7QXJyYXk8U2FsZT59XG4gICAgICAqL1xuICAgICBwdWJsaWMgZ2V0IGdldFNhbGVzTGlzdCgpOiBBcnJheTxTYWxlPiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3NhbGVzO1xuICAgICB9XG5cbiAgICAgLyoqXG4gICAgICAqIEdldHRlciByZW50c1xuICAgICAgKiBAcmV0dXJuIHtBcnJheTxSZW50Pn1cbiAgICAgICovXG4gICAgIHB1YmxpYyBnZXQgZ2V0UmVudHMoKTogQXJyYXk8UmVudD4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9yZW50cztcbiAgICAgfVxuXG4gICAgIC8qKlxuICAgICAgKiBHZXR0ZXIgYm9va1NwZWNpZmljYXRpb25zXG4gICAgICAqIEByZXR1cm4ge0FycmF5PEJvb2tTcGVjaWZpY2F0aW9uPn1cbiAgICAgICovXG4gICAgIHB1YmxpYyBnZXQgZ2V0Qm9va1NwZWNpZmljYXRpb25zKCk6IEFycmF5PEJvb2tTcGVjaWZpY2F0aW9uPiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2Jvb2tTcGVjaWZpY2F0aW9ucztcbiAgICAgfVxuXG4gICAgIC8qKlxuICAgICAgKiBHZXR0ZXIgY2FuY2VsU2FsZXNcbiAgICAgICogQHJldHVybiB7QXJyYXk8Q2FuY2VsU2FsZT59XG4gICAgICAqL1xuICAgICBwdWJsaWMgZ2V0IGdldENhbmNhbGVkU2FsZXMoKTogQXJyYXk8Q2FuY2VsU2FsZT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9jYW5jZWxTYWxlcztcbiAgICAgfVxuXG4gICAgIC8qKlxuICAgICAgKiBHZXR0ZXIgc2FsZUNhcnRcbiAgICAgICogQHJldHVybiB7QXJyYXk8U2FsZUNhcnQ+fVxuICAgICAgKi9cbiAgICAgcHVibGljIGdldCBnZXRTYWxlQ2FydCgpOiBTYWxlQ2FydCB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3NhbGVDYXJ0O1xuICAgICB9XG5cbiAgICAgICAgIC8qKlxuICAgICAqIEdldHRlciByZW50Q2FydFxuICAgICAqIEByZXR1cm4ge1JlbnRDYXJ0fVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IGdldFJlbnRDYXJ0KCk6IFJlbnRDYXJ0IHtcblx0XHRyZXR1cm4gdGhpcy5fcmVudENhcnQ7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBzYWxlQ2FydFxuICAgICAqIEBwYXJhbSB7U2FsZUNhcnR9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgc2V0U2FsZUNhcnQodmFsdWU6IFNhbGVDYXJ0KSB7XG5cdFx0dGhpcy5fc2FsZUNhcnQgPSB2YWx1ZTtcblx0fVxuXG5cblxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIHJlbnRDYXJ0XG4gICAgICogQHBhcmFtIHtSZW50Q2FydH0gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBzZXRSZW50Q2FydCh2YWx1ZTogUmVudENhcnQpIHtcblx0XHR0aGlzLl9yZW50Q2FydCA9IHZhbHVlO1xuXHR9XG4gICAgIFxuXG5cbn1cbiIsImV4cG9ydCBjbGFzcyBCb29rU3BlY2lmaWNhdGlvbiB7XG4gICAgcHJpdmF0ZSBfaXNibjogc3RyaW5nO1xuICAgIHByaXZhdGUgX3ByaWNlOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfc3RhcnREYXRlOiBEYXRlO1xuICAgIHByaXZhdGUgX2VuZERhdGU6IERhdGU7XG5cbiAgICBjb25zdHJ1Y3Rvcihpc2JuOiBzdHJpbmcsIHByaWNlOiBudW1iZXIsIHN0YXJ0RGF0ZTogRGF0ZSwgZW5kRGF0ZTogRGF0ZSkge1xuICAgICAgICB0aGlzLl9pc2JuID0gaXNibjtcbiAgICAgICAgdGhpcy5fcHJpY2UgPSBwcmljZTtcbiAgICAgICAgdGhpcy5fc3RhcnREYXRlID0gc3RhcnREYXRlO1xuICAgICAgICB0aGlzLl9lbmREYXRlID0gZW5kRGF0ZTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBpc2JuXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IGlzYm4oKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5faXNibjtcblx0fVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIHByaWNlXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IHByaWNlKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX3ByaWNlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgc3RhcnREYXRlXG4gICAgICogQHJldHVybiB7RGF0ZX1cbiAgICAgKi9cblx0cHVibGljIGdldCBzdGFydERhdGUoKTogRGF0ZSB7XG5cdFx0cmV0dXJuIHRoaXMuX3N0YXJ0RGF0ZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGVuZERhdGVcbiAgICAgKiBAcmV0dXJuIHtEYXRlfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IGVuZERhdGUoKTogRGF0ZSB7XG5cdFx0cmV0dXJuIHRoaXMuX2VuZERhdGU7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBpc2JuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgaXNibih2YWx1ZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5faXNibiA9IHZhbHVlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgcHJpY2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBwcmljZSh2YWx1ZTogbnVtYmVyKSB7XG5cdFx0dGhpcy5fcHJpY2UgPSB2YWx1ZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIHN0YXJ0RGF0ZVxuICAgICAqIEBwYXJhbSB7RGF0ZX0gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBzdGFydERhdGUodmFsdWU6IERhdGUpIHtcblx0XHR0aGlzLl9zdGFydERhdGUgPSB2YWx1ZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIGVuZERhdGVcbiAgICAgKiBAcGFyYW0ge0RhdGV9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgZW5kRGF0ZSh2YWx1ZTogRGF0ZSkge1xuXHRcdHRoaXMuX2VuZERhdGUgPSB2YWx1ZTtcblx0fVxuICAgIFxuXG4gICAgXG59IiwiaW1wb3J0IHsgQm9va1NwZWNpZmljYXRpb24gfSBmcm9tIFwiLi9ib29rLXNwZWNpZmljYXRpb25cIjtcblxuZXhwb3J0IGNsYXNzIEJvb2sge1xuICBwcml2YXRlIF9pc2JuOiBzdHJpbmc7XG4gIHByaXZhdGUgX25hbWU6IHN0cmluZztcbiAgcHJpdmF0ZSBfYXV0aG9yOiBzdHJpbmc7XG4gIHByaXZhdGUgX3B1Ymxpc2hZZWFyOiBzdHJpbmc7XG4gIHByaXZhdGUgX3BhZ2VzOiBudW1iZXI7XG4gIHByaXZhdGUgX2Jvb2tTcGVjOiBCb29rU3BlY2lmaWNhdGlvbjtcblxuICBjb25zdHJ1Y3Rvcihpc2JuOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgYXV0aG9yOiBzdHJpbmcsIHB1Ymxpc2hZZWFyOiBzdHJpbmcsIHBhZ2VzOiBudW1iZXIsIGJvb2tTcGVjOiBCb29rU3BlY2lmaWNhdGlvbikge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2F1dGhvciA9IGF1dGhvcjtcbiAgICB0aGlzLl9pc2JuID0gaXNibjtcbiAgICB0aGlzLl9wdWJsaXNoWWVhciA9IHB1Ymxpc2hZZWFyO1xuICAgIHRoaXMuX3BhZ2VzID0gcGFnZXM7XG4gICAgdGhpcy5fYm9va1NwZWMgPSBib29rU3BlYztcbiAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgaXNiblxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cblx0cHVibGljIGdldCBpc2JuKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuX2lzYm47XG5cdH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBuYW1lXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IG5hbWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fbmFtZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGF1dGhvclxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cblx0cHVibGljIGdldCBhdXRob3IoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fYXV0aG9yO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgcHVibGlzaFllYXJcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAgICovXG5cdHB1YmxpYyBnZXQgcHVibGlzaFllYXIoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fcHVibGlzaFllYXI7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBwYWdlc1xuICAgICAqIEByZXR1cm4ge251bWJlcn1cbiAgICAgKi9cblx0cHVibGljIGdldCBwYWdlcygpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9wYWdlcztcblx0fVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGJvb2tTcGVjXG4gICAgICogQHJldHVybiB7Qm9va1NwZWNpZmljYXRpb259XG4gICAgICovXG5cdHB1YmxpYyBnZXQgYm9va1NwZWMoKTogQm9va1NwZWNpZmljYXRpb24ge1xuXHRcdHJldHVybiB0aGlzLl9ib29rU3BlYztcblx0fVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIGlzYm5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBpc2JuKHZhbHVlOiBzdHJpbmcpIHtcblx0XHR0aGlzLl9pc2JuID0gdmFsdWU7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBuYW1lXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgbmFtZSh2YWx1ZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5fbmFtZSA9IHZhbHVlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgYXV0aG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgYXV0aG9yKHZhbHVlOiBzdHJpbmcpIHtcblx0XHR0aGlzLl9hdXRob3IgPSB2YWx1ZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIHB1Ymxpc2hZZWFyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgcHVibGlzaFllYXIodmFsdWU6IHN0cmluZykge1xuXHRcdHRoaXMuX3B1Ymxpc2hZZWFyID0gdmFsdWU7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBwYWdlc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICAgICAqL1xuXHRwdWJsaWMgc2V0IHBhZ2VzKHZhbHVlOiBudW1iZXIpIHtcblx0XHR0aGlzLl9wYWdlcyA9IHZhbHVlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgYm9va1NwZWNcbiAgICAgKiBAcGFyYW0ge0Jvb2tTcGVjaWZpY2F0aW9ufSB2YWx1ZVxuICAgICAqL1xuXHRwdWJsaWMgc2V0IGJvb2tTcGVjKHZhbHVlOiBCb29rU3BlY2lmaWNhdGlvbikge1xuXHRcdHRoaXMuX2Jvb2tTcGVjID0gdmFsdWU7XG5cdH1cbiAgXG5cbn1cbiIsImltcG9ydCB7IFNhbGUgfSBmcm9tIFwiLi9zYWxlXCI7XG5cbmV4cG9ydCBjbGFzcyBDYW5jZWxTYWxlIHtcbiAgICBwcml2YXRlIF9zYWxlOiBTYWxlO1xuICAgIHByaXZhdGUgX3JlZnVuZDogbnVtYmVyO1xuICAgIHByaXZhdGUgX2NhbmNlbGVkRGF0ZVRpbWU6IERhdGU7XG5cbiAgICBjb25zdHJ1Y3RvcihzYWxlOiBTYWxlLCByZWZ1bmQ6IG51bWJlciwgY2FuY2VsZWREYXRlVGltZTogRGF0ZSkge1xuICAgICAgICB0aGlzLl9zYWxlID0gc2FsZTtcbiAgICAgICAgdGhpcy5fcmVmdW5kID0gcmVmdW5kO1xuICAgICAgICB0aGlzLl9jYW5jZWxlZERhdGVUaW1lID0gY2FuY2VsZWREYXRlVGltZTtcbiAgICB9O1xuXG4gICAgXG5cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBzYWxlXG4gICAgICogQHJldHVybiB7U2FsZX1cbiAgICAgKi9cblx0cHVibGljIGdldCBzYWxlKCk6IFNhbGUge1xuXHRcdHJldHVybiB0aGlzLl9zYWxlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgcmVmdW5kXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IHJlZnVuZCgpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9yZWZ1bmQ7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBjYW5jZWxlZERhdGVUaW1lXG4gICAgICogQHJldHVybiB7RGF0ZX1cbiAgICAgKi9cblx0cHVibGljIGdldCBjYW5jZWxlZERhdGVUaW1lKCk6IERhdGUge1xuXHRcdHJldHVybiB0aGlzLl9jYW5jZWxlZERhdGVUaW1lO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgc2FsZVxuICAgICAqIEBwYXJhbSB7U2FsZX0gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBzYWxlKHZhbHVlOiBTYWxlKSB7XG5cdFx0dGhpcy5fc2FsZSA9IHZhbHVlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgcmVmdW5kXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgcmVmdW5kKHZhbHVlOiBudW1iZXIpIHtcblx0XHR0aGlzLl9yZWZ1bmQgPSB2YWx1ZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIGNhbmNlbGVkRGF0ZVRpbWVcbiAgICAgKiBAcGFyYW0ge0RhdGV9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgY2FuY2VsZWREYXRlVGltZSh2YWx1ZTogRGF0ZSkge1xuXHRcdHRoaXMuX2NhbmNlbGVkRGF0ZVRpbWUgPSB2YWx1ZTtcblx0fVxuICAgIFxuXG59IiwiZXhwb3J0IGNsYXNzIEN1c3RvbWVyIHtcbiAgcHJpdmF0ZSBfaWQ6IG51bWJlcjtcbiAgcHJpdmF0ZSBfbmFtZTogc3RyaW5nO1xuICBwcml2YXRlIF9zdXJOYW1lOiBzdHJpbmc7XG4gIHByaXZhdGUgX3Bob25lTnVtYmVyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgbmFtZTogc3RyaW5nLCBzdXJOYW1lOiBzdHJpbmcsIHBob25lTnVtYmVyOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9pZCA9IGlkO1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX3N1ck5hbWUgPSBzdXJOYW1lO1xuICAgIHRoaXMuX3Bob25lTnVtYmVyID0gcGhvbmVOdW1iZXI7XG4gIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGlkXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IGlkKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuX2lkO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgbmFtZVxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cblx0cHVibGljIGdldCBuYW1lKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuX25hbWU7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBzdXJOYW1lXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IHN1ck5hbWUoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gdGhpcy5fc3VyTmFtZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIHBob25lTnVtYmVyXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IHBob25lTnVtYmVyKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuIHRoaXMuX3Bob25lTnVtYmVyO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgaWRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBpZCh2YWx1ZTogbnVtYmVyKSB7XG5cdFx0dGhpcy5faWQgPSB2YWx1ZTtcblx0fVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIG5hbWVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBuYW1lKHZhbHVlOiBzdHJpbmcpIHtcblx0XHR0aGlzLl9uYW1lID0gdmFsdWU7XG5cdH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBzdXJOYW1lXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgc3VyTmFtZSh2YWx1ZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5fc3VyTmFtZSA9IHZhbHVlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgcGhvbmVOdW1iZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCBwaG9uZU51bWJlcih2YWx1ZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5fcGhvbmVOdW1iZXIgPSB2YWx1ZTtcblx0fVxuXG5cbn1cbiIsImltcG9ydCB7IEJvb2sgfSBmcm9tIFwiLi9ib29rXCI7XG5cbmV4cG9ydCBjbGFzcyBSZW50Q2FydCB7XG4gICAgY3VzdG9tZXJJZCE6IG51bWJlcjtcbiAgICBib29rQW5kUXVhbnRpdHlNYXA6IE1hcDxCb29rLCBudW1iZXI+O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYm9va0FuZFF1YW50aXR5TWFwID0gbmV3IE1hcDxCb29rLCBudW1iZXI+KCk7XG4gICAgfVxufSIsImltcG9ydCB7IEJvb2sgfSBmcm9tIFwiLi9ib29rXCI7XG5pbXBvcnQgeyBTYWxlIH0gZnJvbSBcIi4vc2FsZVwiO1xuXG5leHBvcnQgY2xhc3MgUmVudCBleHRlbmRzIFNhbGUge1xuICAgIHByaXZhdGUgX3JlZnVuZERhdGU/OkRhdGU7XG4gICAgcHJpdmF0ZSBfcmVmdW5kPzpudW1iZXI7XG5cblxuXHRjb25zdHJ1Y3Rvcihib29rQW5kUXVhbnRpdHlNYXA/OiBNYXA8Qm9vaywgbnVtYmVyPiwgb3BlcmF0aW9uRGF0ZVRpbWU/OiBEYXRlLCBjdXN0b21lcklkPzogbnVtYmVyLCBvcGVyYXRpb25OdW1iZXI/OiBzdHJpbmcsIHRvdGFsPzogbnVtYmVyLHJlZnVuZERhdGU/OiBEYXRlLCByZWZ1bmQ/OiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoYm9va0FuZFF1YW50aXR5TWFwLG9wZXJhdGlvbkRhdGVUaW1lLGN1c3RvbWVySWQsb3BlcmF0aW9uTnVtYmVyLHRvdGFsKVxuICAgICAgICBcblx0XHR0aGlzLl9yZWZ1bmREYXRlID0gcmVmdW5kRGF0ZTtcblx0XHR0aGlzLl9yZWZ1bmQgPSByZWZ1bmQ7XG5cdH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIHJlZnVuZERhdGVcbiAgICAgKiBAcmV0dXJuIHtEYXRlfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IHJlZnVuZERhdGUoKTogRGF0ZSB7XG5cdFx0cmV0dXJuIHRoaXMuX3JlZnVuZERhdGUhO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgcmVmdW5kXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuXHRwdWJsaWMgZ2V0IHJlZnVuZCgpOiBudW1iZXIge1xuXHRcdHJldHVybiB0aGlzLl9yZWZ1bmQhO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgcmVmdW5kRGF0ZVxuICAgICAqIEBwYXJhbSB7RGF0ZX0gdmFsdWVcbiAgICAgKi9cblx0cHVibGljIHNldCByZWZ1bmREYXRlKHZhbHVlOiBEYXRlKSB7XG5cdFx0dGhpcy5fcmVmdW5kRGF0ZSA9IHZhbHVlO1xuXHR9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgcmVmdW5kXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gICAgICovXG5cdHB1YmxpYyBzZXQgcmVmdW5kKHZhbHVlOiBudW1iZXIpIHtcblx0XHR0aGlzLl9yZWZ1bmQgPSB2YWx1ZTtcblx0fVxuXG5cbiAgICBcblxufSIsImltcG9ydCB7IEJvb2sgfSBmcm9tIFwiLi9ib29rXCI7XG5cbmV4cG9ydCBjbGFzcyBTYWxlQ2FydCB7XG4gICAgY3VzdG9tZXJJZCE6IG51bWJlcjtcbiAgICBib29rQW5kUXVhbnRpdHlNYXA6IE1hcDxCb29rLCBudW1iZXI+O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYm9va0FuZFF1YW50aXR5TWFwID0gbmV3IE1hcDxCb29rLCBudW1iZXI+KCk7XG4gICAgfVxufSIsImltcG9ydCB7IEJvb2sgfSBmcm9tIFwiLi9ib29rXCI7XG5cbmV4cG9ydCBjbGFzcyBTYWxlIHtcblxuICAgIHByaXZhdGUgX2Jvb2tBbmRRdWFudGl0eU1hcD8gPSBuZXcgTWFwPEJvb2ssIG51bWJlcj4oKTtcbiAgICBwcml2YXRlIF9jdXN0b21lcklkPzogbnVtYmVyO1xuICAgIHByaXZhdGUgX29wZXJhdGlvbkRhdGVUaW1lPzogRGF0ZTtcbiAgICBwcml2YXRlIF9vcGVyYXRpb25OdW1iZXI/OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfdG90YWw/OiBudW1iZXI7XG5cblxuICAgIGNvbnN0cnVjdG9yKGJvb2tBbmRRdWFudGl0eU1hcD86IE1hcDxCb29rLCBudW1iZXI+LCBvcGVyYXRpb25EYXRlVGltZT86IERhdGUsIGN1c3RvbWVySWQ/OiBudW1iZXIsIG9wZXJhdGlvbk51bWJlcj86IHN0cmluZywgdG90YWw/OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5fYm9va0FuZFF1YW50aXR5TWFwID0gYm9va0FuZFF1YW50aXR5TWFwO1xuICAgICAgICB0aGlzLl9vcGVyYXRpb25EYXRlVGltZSA9IG9wZXJhdGlvbkRhdGVUaW1lO1xuICAgICAgICB0aGlzLl9jdXN0b21lcklkID0gY3VzdG9tZXJJZDtcbiAgICAgICAgdGhpcy5fb3BlcmF0aW9uTnVtYmVyID0gb3BlcmF0aW9uTnVtYmVyO1xuICAgICAgICB0aGlzLl90b3RhbCA9IHRvdGFsO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGJvb2tBbmRRdWFudGl0eU1hcFxuICAgICAqIEByZXR1cm4ge01hcDxCb29rLCBudW1iZXI+KCl9XG4gICAgICovXG4gICAgcHVibGljIGdldCBib29rQW5kUXVhbnRpdHlNYXAoKTogTWFwPEJvb2ssIG51bWJlcj4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm9va0FuZFF1YW50aXR5TWFwITtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBvcGVyYXRpb25EYXRlVGltZVxuICAgICAqIEByZXR1cm4ge0RhdGV9XG4gICAgICovXG4gICAgcHVibGljIGdldCBvcGVyYXRpb25EYXRlVGltZSgpOiBEYXRlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29wZXJhdGlvbkRhdGVUaW1lITtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgY3VzdG9tZXJJZFxuICAgICAqIEByZXR1cm4ge251bWJlcn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGN1c3RvbWVySWQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbWVySWQhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBvcGVyYXRpb25OdW1iZXJcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAgICovXG4gICAgcHVibGljIGdldCBvcGVyYXRpb25OdW1iZXIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29wZXJhdGlvbk51bWJlciE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIHRvdGFsXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgdG90YWwoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RvdGFsITtcbiAgICB9XG5cblxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIGJvb2tBbmRRdWFudGl0eU1hcFxuICAgICAqIEBwYXJhbSB7TWFwfSB2YWx1ZVxuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgYm9va0FuZFF1YW50aXR5TWFwKHZhbHVlOiBNYXA8Qm9vaywgbnVtYmVyPikge1xuICAgICAgICB0aGlzLl9ib29rQW5kUXVhbnRpdHlNYXAgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgb3BlcmF0aW9uRGF0ZVRpbWVcbiAgICAgKiBAcGFyYW0ge0RhdGV9IHZhbHVlXG4gICAgICovXG4gICAgcHVibGljIHNldCBvcGVyYXRpb25EYXRlVGltZSh2YWx1ZTogRGF0ZSkge1xuICAgICAgICB0aGlzLl9vcGVyYXRpb25EYXRlVGltZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBjdXN0b21lcklkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlXG4gICAgICovXG4gICAgcHVibGljIHNldCBjdXN0b21lcklkKHZhbHVlOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5fY3VzdG9tZXJJZCA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBvcGVyYXRpb25OdW1iZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IG9wZXJhdGlvbk51bWJlcih2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX29wZXJhdGlvbk51bWJlciA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciB0b3RhbFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgdG90YWwodmFsdWU6IG51bWJlcikge1xuICAgICAgICB0aGlzLl90b3RhbCA9IHZhbHVlO1xuICAgIH1cblxuXG59IiwiZXhwb3J0IGNsYXNzIFN0b2NrIHtcbiAgICBwcml2YXRlIF9pc2JuOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfcXVhbnRpdHk6IG51bWJlcjtcbiAgICBwcml2YXRlIF9zaGVsZk51bWJlcjogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoaXNibj86IHN0cmluZywgcXVhbnRpdHk/OiBudW1iZXIsIHNoZWxmTnVtYmVyPzogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2lzYm4gPSBpc2JuITtcbiAgICAgICAgdGhpcy5fcXVhbnRpdHkgPSBxdWFudGl0eSE7XG4gICAgICAgIHRoaXMuX3NoZWxmTnVtYmVyID0gc2hlbGZOdW1iZXIhO1xuICAgIH1cblxuXG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgaXNiblxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGlzYm4oKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzYm47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIHF1YW50aXR5XG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgcXVhbnRpdHkoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1YW50aXR5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBzaGVsZk51bWJlclxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHNoZWxmTnVtYmVyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaGVsZk51bWJlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgaXNiblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZVxuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgaXNibih2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2lzYm4gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgcXVhbnRpdHlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IHF1YW50aXR5KHZhbHVlOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5fcXVhbnRpdHkgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgc2hlbGZOdW1iZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IHNoZWxmTnVtYmVyKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fc2hlbGZOdW1iZXIgPSB2YWx1ZTtcbiAgICB9XG5cblxufSIsIi8vIGV4cG9ydCBOT0RFX09QVElPTlM9LS1vcGVuc3NsLWxlZ2FjeS1wcm92aWRlclxuaW1wb3J0IHsgRGF0YUJhc2UgfSBmcm9tIFwiLi9kYi9kYXRhYmFzZVwiO1xuaW1wb3J0IHsgQm9vayB9IGZyb20gXCIuL2RvbWFpbi9ib29rXCI7XG5pbXBvcnQgeyBCb29rU3BlY2lmaWNhdGlvbiB9IGZyb20gXCIuL2RvbWFpbi9ib29rLXNwZWNpZmljYXRpb25cIjtcbmltcG9ydCB7IENhbmNlbFNhbGUgfSBmcm9tIFwiLi9kb21haW4vY2FuY2FsLXNhbGVcIjtcbmltcG9ydCB7IEN1c3RvbWVyIH0gZnJvbSBcIi4vZG9tYWluL2N1c3RvbWVyXCI7XG5pbXBvcnQgeyBTYWxlIH0gZnJvbSBcIi4vZG9tYWluL3NhbGVcIjtcbmltcG9ydCB7IFN0b2NrIH0gZnJvbSBcIi4vZG9tYWluL3N0b2NrXCI7XG5pbXBvcnQgeyBCb29rU2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2UvYm9vay1zZXJ2aWNlXCI7XG5pbXBvcnQgeyBDYW5jZWxTYWxlU2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2UvY2FuY2FsLXNhbGUtc2VydmljZVwiO1xuaW1wb3J0IHsgQ3VzdG9tZXJTZXJ2aWNlIH0gZnJvbSBcIi4vc2VydmljZS9jdXN0b21lci1zZXJ2aWNlXCI7XG5pbXBvcnQgeyBSZW50U2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2UvcmVudC1zZXJ2aWNlXCI7XG5pbXBvcnQgeyBTYWxlU2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2Uvc2FsZS1zZXJ2aWNlXCI7XG5pbXBvcnQgeyBTdG9ja1NlcnZpY2UgfSBmcm9tIFwiLi9zZXJ2aWNlL3N0b2NrLXNlcnZpY2VcIjtcblxuZXhwb3J0IGxldCBib29rU2VydmljZTogQm9va1NlcnZpY2U7XG5leHBvcnQgbGV0IGN1c3RvbWVyU2VydmljZTogQ3VzdG9tZXJTZXJ2aWNlO1xuZXhwb3J0IGxldCBjYW5jZWxTYWxlU2VydmljZTogQ2FuY2VsU2FsZVNlcnZpY2U7XG5leHBvcnQgbGV0IHJlbnRTZXJ2aWNlOiBSZW50U2VydmljZTtcbmV4cG9ydCBsZXQgc2FsZVNlcnZpY2U6IFNhbGVTZXJ2aWNlO1xuZXhwb3J0IGxldCBzdG9ja1NlcnZpY2U6IFN0b2NrU2VydmljZTtcblxubGV0IGRiOiBEYXRhQmFzZSA9IG5ldyBEYXRhQmFzZSgpO1xuaW5pdGlsaWF6ZVNlcnZpY2VzKGRiKTtcbmluaXRpbGlhemVEYXRhKCk7XG5hZGRMaXN0ZW5lckZvck1lbnVJdGVtcygpO1xuXG5cblxuZnVuY3Rpb24gaW5pdGlsaWF6ZVNlcnZpY2VzKGRiOiBEYXRhQmFzZSkge1xuICBib29rU2VydmljZSA9IG5ldyBCb29rU2VydmljZShkYi5nZXRCb29rc0xpc3QsIGRiLmdldEJvb2tTcGVjaWZpY2F0aW9ucyk7XG4gIGN1c3RvbWVyU2VydmljZSA9IG5ldyBDdXN0b21lclNlcnZpY2UoZGIuZ2V0Q3VzdG9tZXJzTGlzdCk7XG4gIGNhbmNlbFNhbGVTZXJ2aWNlID0gbmV3IENhbmNlbFNhbGVTZXJ2aWNlKGRiLmdldENhbmNhbGVkU2FsZXMpO1xuICByZW50U2VydmljZSA9IG5ldyBSZW50U2VydmljZShkYi5nZXRSZW50cywgZGIuZ2V0UmVudENhcnQpO1xuICBzYWxlU2VydmljZSA9IG5ldyBTYWxlU2VydmljZShkYi5nZXRTYWxlc0xpc3QsIGRiLmdldFNhbGVDYXJ0KTtcbiAgc3RvY2tTZXJ2aWNlID0gbmV3IFN0b2NrU2VydmljZShkYi5nZXRTdG9ja3NMaXN0KTtcbiAgY29uc29sZS5sb2coXCJTZXJ2aWNlcyBpbnRpbGlhemVkLlwiKTtcblxuICBjdXN0b21lclNlcnZpY2UuYWRkQ3VzdG9tZXIobmV3IEN1c3RvbWVyKDEsIFwiXCIsIFwiXCIsIFwiXCIpKTtcbiAgY3VzdG9tZXJTZXJ2aWNlLmFkZEN1c3RvbWVyKG5ldyBDdXN0b21lcigyLCBcIlwiLCBcIlwiLCBcIlwiKSk7XG5cbiAgc3RvY2tTZXJ2aWNlLmFkZFN0b2NrKFwiMTIzLTQ1XCIsIFwiQTQ1LTUyXCIsIDEwKTtcbiAgc3RvY2tTZXJ2aWNlLmFkZFN0b2NrKFwiMTIzLTQ2XCIsIFwiQTQ1LTUyXCIsIDEwKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaW5pdGlsaWF6ZURhdGEoKSB7XG4gIGF3YWl0IGJvb2tTZXJ2aWNlLmluaXRpYWxpemVEYXRhTW9jaygpO1xuXG5cbn1cblxuZnVuY3Rpb24gYWRkTGlzdGVuZXJGb3JNZW51SXRlbXMoKSB7XG4gIC8vc2FsZVNlcnZpY2UudXBkYXRlU2FsZUNhcnQoKTtcbiAgc2hvd0FuZEhpZGUoXCJhZGRCb29rTWVudUl0ZW1cIiwgXCJhZGRCb29rU2VjdGlvblwiKTtcbiAgc2hvd0FuZEhpZGUoXCJzaG93Qm9va3NNZW51SXRlbVwiLCBcImxpc3RCb29rc1NlY3Rpb25cIik7XG4gIHNob3dBbmRIaWRlKFwiYWRkQ3VzdG9tZXJNZW51SXRlbVwiLCBcImFkZEN1c3RvbWVyU2VjdGlvblwiKTtcbiAgc2hvd0FuZEhpZGUoXCJhZGRTdG9ja01lbnVJdGVtXCIsIFwiYWRkU3RvY2tTZWN0aW9uXCIpO1xuICBzaG93QW5kSGlkZShcInNhbGVCb29rTWVudUl0ZW1cIiwgXCJzYWxlQm9va1NlY3Rpb25cIik7XG4gIHNob3dBbmRIaWRlKFwicmVudEJvb2tNZW51SXRlbVwiLCBcInJlbnRCb29rU2VjdGlvblwiKTtcbiAgc2hvd0FuZEhpZGUoXCJjYW5jZWxTYWxlTWVudUl0ZW1cIiwgXCJjYW5jZWxTYWxlU2VjdGlvblwiKTtcbn1cblxuZnVuY3Rpb24gc2hvd0FuZEhpZGUoYnRuSWQ6IHN0cmluZywgZWxlbWVudElkOiBzdHJpbmcpIHtcbiAgLy9zYWxlU2VydmljZS51cGRhdGVTYWxlQ2FydCgpO1xuXG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChidG5JZCk7XG5cbiAgaWYgKGVsZW1lbnQgJiYgYnRuKSB7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAoZWxlbWVudC5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIikge1xuICAgICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBhZGRCb29rRm9ybSA9IDxIVE1MRm9ybUVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtYm9vay1mb3JtXCIpO1xuaWYgKGFkZEJvb2tGb3JtICE9IG51bGwpIHtcbiAgYWRkQm9va0Zvcm0ub25zdWJtaXQgPSBhc3luYyAoZSkgPT4ge1xuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGFkZEJvb2tGb3JtKTtcblxuICAgIGNvbnN0IHRpdGxlID0gZm9ybURhdGEuZ2V0KFwiYm9va1RpdGxlXCIpIGFzIHN0cmluZztcbiAgICBjb25zdCBhdXRob3IgPSBmb3JtRGF0YS5nZXQoXCJib29rQXV0aG9yXCIpIGFzIHN0cmluZztcbiAgICBjb25zdCBpc2JuID0gZm9ybURhdGEuZ2V0KFwiYm9va0lzYm5cIikgYXMgc3RyaW5nO1xuICAgIGNvbnN0IHB1Ymxpc2hZZWFyID0gZm9ybURhdGEuZ2V0KFwiYm9va1B1Ymxpc2hZZWFyXCIpIGFzIHN0cmluZztcbiAgICBjb25zdCBwYWdlcyA9IGZvcm1EYXRhLmdldChcImJvb2tQYWdlc1wiKSBhcyB1bmtub3duIGFzIG51bWJlcjtcbiAgICBjb25zdCBwcmljZSA9IGZvcm1EYXRhLmdldChcImJvb2tQcmljZVwiKSBhcyB1bmtub3duIGFzIG51bWJlcjtcbiAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSgnRGVjIDMxLCA5OTk5IDIzOjU5OjU5Jyk7XG5cbiAgICBjb25zdCBib29rU3BlYyA9IG5ldyBCb29rU3BlY2lmaWNhdGlvbihpc2JuLCBwcmljZSwgc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgICBjb25zdCBib29rID0gbmV3IEJvb2soaXNibiwgdGl0bGUsIGF1dGhvciwgcHVibGlzaFllYXIsIHBhZ2VzLCBib29rU3BlYyk7XG4gICAgLy9ib29rU2VydmljZS5hZGRCb29rKGJvb2spO1xuXG4gICAgbGV0IHN1Y2Nlc3MgPSBhd2FpdCBib29rU2VydmljZS5hZGRCb29rTW9jayhib29rKTtcbiAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgYWxlcnQoYm9vay5pc2JuICsgXCIgbnVtYXJhbMSxIEtpdGFwIEVrbGVtZSDEsMWfbGVtaSBCYcWfYXLEsSDEsGxlIFRhbWFtbGFubcSxxZ90xLFyLlwiKTtcbiAgICAgIGFkZEJvb2tGb3JtLnJlc2V0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KGJvb2suaXNibiArIFwiIG51bWFyYWzEsSBLaXRhcCBFa2xlbWUgxLDFn2xlbWkgU8SxcmFzxLFuZGEgQmlyIEhhdGEgb2x1xZ90dS5cIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlOyAvLyBwcmV2ZW50IHJlbG9hZFxuICB9O1xufVxuXG5jb25zdCBhZGRTdG9ja0Zvcm0gPSA8SFRNTEZvcm1FbGVtZW50Pihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZC1zdG9jay1mb3JtXCIpKTtcbmlmIChhZGRTdG9ja0Zvcm0pIHtcbiAgYWRkU3RvY2tGb3JtLm9uc3VibWl0ID0gYXN5bmMgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoYWRkU3RvY2tGb3JtKTtcblxuICAgIGNvbnN0IGlzYm4gPSBmb3JtRGF0YS5nZXQoXCJib29rSXNibkZvckFkZFN0b2NrXCIpIGFzIHN0cmluZztcbiAgICBjb25zdCBxdWFudHRpeSA9IGZvcm1EYXRhLmdldChcInN0b2NrUXVhbnRpdHlcIikgYXMgdW5rbm93biBhcyBudW1iZXI7XG4gICAgY29uc3Qgc2hlbGZOdW1iZXIgPSBmb3JtRGF0YS5nZXQoXCJzaGVsZk51bWJlclwiKSBhcyBzdHJpbmc7XG5cbiAgICBjb25zdCBzdG9jayA9IG5ldyBTdG9jayhpc2JuLCBxdWFudHRpeSwgc2hlbGZOdW1iZXIpO1xuXG4gICAgY29uc3QgaXNDb250YWluc0Jvb2sgPSBib29rU2VydmljZS5ib29rTGlzdC5zb21lKGIgPT4gYi5pc2JuID09IGlzYm4pO1xuXG4gICAgaWYgKCFpc0NvbnRhaW5zQm9vaykge1xuICAgICAgYWxlcnQoXCJTdG9rIGVrbGVubWV5ZSDDp2FsxLHFn8SxbGFuIGtpdGFwLCBrYXnEsXRsxLEgZGXEn2lsZGlyLiBMw7x0ZmVuIMO2bmNlIGtpdGFwIGVrbGV5aW5pelwiKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBsZXQgaXNPayA9IGF3YWl0IHN0b2NrU2VydmljZS5hZGRTdG9ja01vY2soc3RvY2spO1xuXG4gICAgICBpZiAoaXNPaykge1xuICAgICAgICBhbGVydChpc2JuICsgXCIgaXNibiBudW1hcmFsxLEga2l0YXB0YW4sIFwiICsgcXVhbnR0aXkgKyBcIiBrYWRhciBzaXN0ZW1lIHN0b2sgZWtsZW5tacWfdGlyLlwiKTtcbiAgICAgIH1cblxuXG4gICAgfVxuXG4gICAgYWRkU3RvY2tGb3JtLnJlc2V0KCk7XG4gICAgcmV0dXJuIGZhbHNlOyAvLyBwcmV2ZW50IHJlbG9hZFxuICB9O1xufVxuXG4vKipcbiAqIE3DvMWfdGVyaSBla2xlbWUgZm9ybXUgc3VibWl0IG9sYXnEsW7EsSBtb2NrIGN1c3RvbWVyU2VydmljZSBkZWtpIG1vY2sgc2VydmlzZSBiYcSfbGFkxLFtXG4gKi9cbmNvbnN0IGFkZEN1c3RvbWVyRm9ybSA9IDxIVE1MRm9ybUVsZW1lbnQ+KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLWN1c3RvbWVyLWZvcm1cIikpO1xuaWYgKGFkZEN1c3RvbWVyRm9ybSkge1xuICBhZGRDdXN0b21lckZvcm0ub25zdWJtaXQgPSBhc3luYyAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShhZGRDdXN0b21lckZvcm0pO1xuXG4gICAgY29uc3QgbmFtZSA9IGZvcm1EYXRhLmdldChcImN1c3RvbWVyTmFtZVwiKSBhcyBzdHJpbmc7XG4gICAgY29uc3Qgc3VybmFtZSA9IGZvcm1EYXRhLmdldChcImN1c3RvbWVyU3VybmFtZVwiKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgcGhvbmVOdW1iZXIgPSBmb3JtRGF0YS5nZXQoXCJjdXN0b21lclBob25lTnVtYmVyXCIpIGFzIHN0cmluZztcblxuICAgIGNvbnN0IGN1c3RvbWVyID0gbmV3IEN1c3RvbWVyKGN1c3RvbWVyU2VydmljZS5nZXROZXdDdXN0b21lcklkKCksIG5hbWUsIHN1cm5hbWUsIHBob25lTnVtYmVyKTtcbiAgICBhd2FpdCBjdXN0b21lclNlcnZpY2UuYWRkQ3VzdG9tZXJNb2NrKGN1c3RvbWVyKTtcblxuICAgIGFsZXJ0KFwiTcO8xZ90ZXJpIEVrbGVtZSDEsMWfbGVtaSBCYcWfYXLEsSDEsGxlIFRhbWFtbGFubcSxxZ90xLFyLiBcIik7XG4gICAgYWRkQ3VzdG9tZXJGb3JtLnJlc2V0KCk7XG4gICAgcmV0dXJuIGZhbHNlOyAvLyBwcmV2ZW50IHJlbG9hZFxuICB9O1xufVxuXG4vKipCdXJhZGEgbW9jayBzZXJ2aXNpIHlvayDDp8O8bmvDvCBidXJhZGEga2l0YXAgc2F0xLHFn8SxIHlhcMSxbMSxcmtlbiwga2l0YXBsYXLEsSBzZXBldGUgZWtsaXlvcnV6LlxuICogU2VwZXRlIGVrbGVkaWt0ZW4gc29ucmEgYnRuU2FsZSBpZGxpIGJ1dG9udW4gY2xpY2sgZXZlbnRpLCBtb2NrIHNlcnZpc2kgw6dhxJ/EsXLEsXlvclxuICovXG5jb25zdCBzYWxlQm9va0Zvcm0gPSA8SFRNTEZvcm1FbGVtZW50Pihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNhbGUtYm9vay1mb3JtXCIpKTtcbmlmIChzYWxlQm9va0Zvcm0pIHtcbiAgc2FsZUJvb2tGb3JtLm9uc3VibWl0ID0gKCkgPT4ge1xuXG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoc2FsZUJvb2tGb3JtKTtcblxuICAgIGNvbnN0IGlzYm4gPSBmb3JtRGF0YS5nZXQoXCJpc2JuRm9yU2FsZVwiKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgYm9vayA9IGJvb2tTZXJ2aWNlLmdldEJvb2soaXNibik7XG4gICAgY29uc3QgY3VzdG9tZXJJZCA9IHBhcnNlSW50KGZvcm1EYXRhLmdldChcImN1c3RvbWVySWRGb3JTYWxlXCIpIGFzIHN0cmluZyk7XG4gICAgY29uc3QgaXNWYWxpZEN1c3RvbWVyOiBib29sZWFuID0gY3VzdG9tZXJTZXJ2aWNlLmlzVmFsaWRDdXN0b21lcihjdXN0b21lcklkKTtcbiAgICBjb25zdCBxdWFudGl0eSA9IHBhcnNlSW50KGZvcm1EYXRhLmdldChcInF1YW50aXR5Rm9yU2FsZVwiKSBhcyBzdHJpbmcpO1xuXG4gICAgY29uc3Qgc3RvY2sgPSBzdG9ja1NlcnZpY2UuZ2V0U3RvY2soaXNibikhO1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChib29rKSB7XG4gICAgICAgIGlmIChzdG9jaykge1xuICAgICAgICAgIGlmIChzdG9jay5xdWFudGl0eSA+PSBxdWFudGl0eSkge1xuICAgICAgICAgICAgaWYgKGlzVmFsaWRDdXN0b21lcikge1xuICAgICAgICAgICAgICBzYWxlU2VydmljZS5hZGRCb29rVG9DYXJ0KGJvb2ssIHF1YW50aXR5LCBjdXN0b21lcklkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGFsZXJ0KGN1c3RvbWVySWQgKyBcIiBudW1hcmFsxLEgbcO8xZ90ZXJpIGthecSxdGzEsSBkZcSfaWxkaXIuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGFsZXJ0KHF1YW50aXR5ICsgXCIga2FkYXIga2l0YXAgZMO8a2thbmRhIG1ldmN1dCBkZcSfaWxkaXIuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhbGVydChgRMO8a2thbmRhICR7aXNibn0gbnVtYXJhbMSxIGtpdGFixLFuIHN0b8SfdSBtZXZjdXQgZGXEn2lsZGlyLmApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhbGVydChpc2JuICsgXCIgbnVtYXJhbMSxIGtpdGFwIHlva3R1ci5cIik7XG4gICAgICB9XG5cbiAgICAgIHNhbGVCb29rRm9ybS5yZXNldCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGFsZXJ0KGVycm9yKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBLaXRhcCBzYXTEscWfxLEgacOnaW4gacWfbGVtIHlhcMSxbMSxcmtlbiBraXRhcGxhciBzZXBldGUgZWtsZW5peW9yLlxuICogRWtsZW1lIGnFn2xlbWkgYml0dGlrdGVuIHNvbnJhIHNhdMSxbiBhbG0gaWnDp2luIGJ1IGJ1dG9uYSB0xLFrbGFuZMSxxJ/EsW5kYSBzZXJ2aXNlIGdpZGlwIHNlcGV0dGVraSBraXRhcGxhcsSxbiBzYXTEscWfxLEgZ2Vyw6dla2xlxZ9peW9yXG4gKiBCdXJhZGEgZGnEn2VyIGJ1dG9ubGFyZGEgb2xkdcSfdSBnaWJpIGRpcmVrIG1vY2sgc2VydmlzaW5lIGJhxJ9sYW5tYWsgeWVyaW5lIHNlcnZpc2UgZ2l0bWVrIGR1cnVtdW5kYXnEsXouIFxuICogw4fDvG5rw7wgc2VydmlzdGUgU2FsZSBuZXNuZXNpbmkgb2x1xZ90dXJ1cCBtb2NrIHNlcnZpc2luZSBwYXJhbWV0cmUgb2xhcmsgZ2XDp2l5b3J1ei5cbiAqL1xuY29uc3QgYnRuU2FsZSA9IDxIVE1MQnV0dG9uRWxlbWVudD4oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG5TYWxlXCIpKTtcbmJ0blNhbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaWYgKHNhbGVTZXJ2aWNlLnNhbGVDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcC5zaXplID09PSAwKSB7XG4gICAgYWxlcnQoXCJTZXBldHRlIMO8csO8biB5b2suIEzDvHRmZW4gw7ZuY2Ugw7xyw7xuIGVrbGV5aW5pelwiKTtcbiAgfSBlbHNlIHtcbiAgICBzYWxlU2VydmljZS5jYXJ0VG9TYWxlKCk7XG4gIH1cblxufSk7XG5cbi8qKlxuICogS2l0YXBsYXLEsSBsaXN0ZWxlbWVrIGnDp2luIHTEsWtsYW7EsWxhbiBidXRvbiBjbGljayBldmVudGlcbiAqL1xuY29uc3QgYnRuU2hvd0Jvb2tzTWVudUl0ZW0gPSA8SFRNTEVsZW1lbnQ+KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2hvd0Jvb2tzTWVudUl0ZW1cIikpO1xuYnRuU2hvd0Jvb2tzTWVudUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYm9va1NlcnZpY2UubGlzdEJvb2tzKCk7XG59KVxuXG5jb25zdCBjYW5jZWxTYWxlRm9ybSA9IDxIVE1MRm9ybUVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWwtc2FsZS1mb3JtXCIpO1xuaWYgKGNhbmNlbFNhbGVGb3JtKSB7XG4gIGNhbmNlbFNhbGVGb3JtLm9uc3VibWl0ID0gYXN5bmMgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBsZXQgYnEgPSBuZXcgTWFwPEJvb2ssIG51bWJlcj4oKTtcbiAgICBicS5zZXQoYm9va1NlcnZpY2UuZ2V0Qm9vayhcIjEyMy00NVwiKSwgMyk7XG5cbiAgICBsZXQgYSA9IG5ldyBTYWxlKGJxLCBuZXcgRGF0ZSwgMSwgXCJTMDIxMTIyMTYzMDQ1XCIsIDEyMyk7XG4gICAgc2FsZVNlcnZpY2Uuc2FsZUxpc3QucHVzaChhKTtcblxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGNhbmNlbFNhbGVGb3JtKTtcbiAgICBjb25zdCBzYWxlTnVtYmVyID0gZm9ybURhdGEuZ2V0KFwic2FsZU51bWJlcmZvckNhbmNlbFwiKSBhcyBzdHJpbmc7XG5cbiAgICBsZXQgc2FsZSA9IHNhbGVTZXJ2aWNlLmdldFNhbGUoc2FsZU51bWJlcik7XG5cbiAgICBpZiAoc2FsZSkge1xuICAgICAgbGV0IGNhbmNlbFNhbGU6IENhbmNlbFNhbGUgPSBuZXcgQ2FuY2VsU2FsZShzYWxlLCBzYWxlLnRvdGFsLCBuZXcgRGF0ZSk7XG4gICAgICBsZXQgc3RhdGUgPSBhd2FpdCBjYW5jZWxTYWxlU2VydmljZS5jYW5jZWxTYWxlTW9jayhjYW5jZWxTYWxlKTtcblxuICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgIGFsZXJ0KHNhbGUub3BlcmF0aW9uTnVtYmVyICsgXCIgbnVtYXJhbMSxIHNhdMSxxZ8gaXB0YWwgZWRpbG1pxZ90aXIuXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWxlcnQoc2FsZS5vcGVyYXRpb25OdW1iZXIgKyBcIiBudW1hcmFsxLEgc2F0xLHFnyBpcHRhbCBlZGlsaXJrZW4gaGF0YSBtZXlkYW5hIGdlbGRpLlwiKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoc2FsZU51bWJlciArIFwiIG51bWFyYWzEsSBzYXTEscWfIGJ1bHVuYW1hbcSxxZ90xLFyLiBUZWtyYXIgZGVuZXlpbml6LlwiKTtcbiAgICB9XG5cbiAgfVxufVxuXG4vKipCdXJhZGEgbW9jayBzZXJ2aXNpIHlvayDDp8O8bmvDvCBidXJhZGEga2l0YXAga2lyYWxhbWFzxLEgeWFwxLFsxLFya2VuLCBraXRhcGxhcsSxIHNlcGV0ZSBla2xpeW9ydXouXG4gKiBTZXBldGUgZWtsZWRpa3RlbiBzb25yYSBidG5SZW50IGlkbGkgYnV0b251biBjbGljayBldmVudGksIG1vY2sgc2VydmlzaSDDp2HEn8SxcsSxeW9yXG4gKi9cbmNvbnN0IHJlbnRCb29rRm9ybSA9IDxIVE1MRm9ybUVsZW1lbnQ+KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVudC1ib29rLWZvcm1cIikpO1xuaWYgKHJlbnRCb29rRm9ybSkge1xuICByZW50Qm9va0Zvcm0ub25zdWJtaXQgPSAoKSA9PiB7XG5cbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShyZW50Qm9va0Zvcm0pO1xuXG4gICAgY29uc3QgaXNibiA9IGZvcm1EYXRhLmdldChcImlzYm5Gb3JSZW50XCIpIGFzIHN0cmluZztcbiAgICBjb25zdCBib29rID0gYm9va1NlcnZpY2UuZ2V0Qm9vayhpc2JuKTtcbiAgICBjb25zdCBjdXN0b21lcklkID0gcGFyc2VJbnQoZm9ybURhdGEuZ2V0KFwiY3VzdG9tZXJJZEZvclJlbnRcIikgYXMgc3RyaW5nKTtcbiAgICBjb25zdCBpc1ZhbGlkQ3VzdG9tZXI6IGJvb2xlYW4gPSBjdXN0b21lclNlcnZpY2UuaXNWYWxpZEN1c3RvbWVyKGN1c3RvbWVySWQpO1xuICAgIGNvbnN0IHF1YW50aXR5ID0gcGFyc2VJbnQoZm9ybURhdGEuZ2V0KFwicXVhbnRpdHlGb3JSZW50XCIpIGFzIHN0cmluZyk7XG5cbiAgICBjb25zdCBzdG9jayA9IHN0b2NrU2VydmljZS5nZXRTdG9jayhpc2JuKSE7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKGJvb2spIHtcbiAgICAgICAgaWYgKHN0b2NrKSB7XG4gICAgICAgICAgaWYgKHN0b2NrLnF1YW50aXR5ID49IHF1YW50aXR5KSB7XG4gICAgICAgICAgICBpZiAoaXNWYWxpZEN1c3RvbWVyKSB7XG4gICAgICAgICAgICAgIHJlbnRTZXJ2aWNlLmFkZEJvb2tUb0NhcnQoYm9vaywgcXVhbnRpdHksIGN1c3RvbWVySWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYWxlcnQoY3VzdG9tZXJJZCArIFwiIG51bWFyYWzEsSBtw7zFn3Rlcmkga2F5xLF0bMSxIGRlxJ9pbGRpci5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYWxlcnQocXVhbnRpdHkgKyBcIiBrYWRhciBraXRhcCBkw7xra2FuZGEgbWV2Y3V0IGRlxJ9pbGRpci5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFsZXJ0KGBEw7xra2FuZGEgJHtpc2JufSBudW1hcmFsxLEga2l0YWLEsW4gc3RvxJ91IG1ldmN1dCBkZcSfaWxkaXIuYCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFsZXJ0KGlzYm4gKyBcIiBudW1hcmFsxLEga2l0YXAgeW9rdHVyLlwiKTtcbiAgICAgIH1cblxuICAgICAgcmVudEJvb2tGb3JtLnJlc2V0KCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgYWxlcnQoZXJyb3IpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEtpdGFwIHNhdMSxxZ/EsSBpw6dpbiBpxZ9sZW0geWFwxLFsxLFya2VuIGtpdGFwbGFyIHNlcGV0ZSBla2xlbml5b3IuXG4gKiBFa2xlbWUgacWfbGVtaSBiaXR0aWt0ZW4gc29ucmEgc2F0xLFuIGFsbSBpacOnaW4gYnUgYnV0b25hIHTEsWtsYW5kxLHEn8SxbmRhIHNlcnZpc2UgZ2lkaXAgc2VwZXR0ZWtpIGtpdGFwbGFyxLFuIHNhdMSxxZ/EsSBnZXLDp2VrbGXFn2l5b3JcbiAqIEJ1cmFkYSBkacSfZXIgYnV0b25sYXJkYSBvbGR1xJ91IGdpYmkgZGlyZWsgbW9jayBzZXJ2aXNpbmUgYmHEn2xhbm1hayB5ZXJpbmUgc2VydmlzZSBnaXRtZWsgZHVydW11bmRhecSxei4gXG4gKiDDh8O8bmvDvCBzZXJ2aXN0ZSBTYWxlIG5lc25lc2luaSBvbHXFn3R1cnVwIG1vY2sgc2VydmlzaW5lIHBhcmFtZXRyZSBvbGFyayBnZcOnaXlvcnV6LlxuICovXG5jb25zdCBidG5SZW50ID0gPEhUTUxCdXR0b25FbGVtZW50Pihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0blJlbnRcIikpO1xuYnRuUmVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBpZiAocmVudFNlcnZpY2UucmVudENhcnQuYm9va0FuZFF1YW50aXR5TWFwLnNpemUgPT09IDApIHtcbiAgICBhbGVydChcIlNlcGV0dGUgw7xyw7xuIHlvay4gTMO8dGZlbiDDtm5jZSDDvHLDvG4gZWtsZXlpbml6XCIpO1xuICB9IGVsc2Uge1xuICAgIHJlbnRTZXJ2aWNlLmNhcnRUb1JlbnQoKTtcbiAgfVxuXG59KTsiLCJcbmltcG9ydCB7IHN0b2NrU2VydmljZSB9IGZyb20gXCIuLlwiO1xuaW1wb3J0IHsgQm9vayB9IGZyb20gXCIuLi9kb21haW4vYm9va1wiO1xuaW1wb3J0IHsgQm9va1NwZWNpZmljYXRpb24gfSBmcm9tIFwiLi4vZG9tYWluL2Jvb2stc3BlY2lmaWNhdGlvblwiO1xuXG5leHBvcnQgY2xhc3MgQm9va1NlcnZpY2Uge1xuICAgIHByaXZhdGUgX2Jvb2tMaXN0OiBBcnJheTxCb29rPjtcbiAgICBwcml2YXRlIF9ib29rU3BlY0xpc3Q6IEFycmF5PEJvb2tTcGVjaWZpY2F0aW9uPjtcbiAgICBib29rQXBpOiBzdHJpbmcgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAyL2FwaS9ib29rcy8nO1xuICAgIGNvbnN0cnVjdG9yKGJvb2tMaXN0OiBBcnJheTxCb29rPiwgYm9va1NwZWNMaXN0OiBBcnJheTxCb29rU3BlY2lmaWNhdGlvbj4pIHtcbiAgICAgICAgdGhpcy5fYm9va0xpc3QgPSBib29rTGlzdDtcbiAgICAgICAgdGhpcy5fYm9va1NwZWNMaXN0ID0gYm9va1NwZWNMaXN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBkYXRhQmFzZVxuICAgICAqIEByZXR1cm4ge0RhdGFCYXNlfVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgYm9va0xpc3QoKTogQXJyYXk8Qm9vaz4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm9va0xpc3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIGRhdGFCYXNlXG4gICAgICogQHBhcmFtIHtEYXRhQmFzZX0gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IGJvb2tMaXN0KHZhbHVlOiBBcnJheTxCb29rPikge1xuICAgICAgICB0aGlzLl9ib29rTGlzdCA9IHZhbHVlO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGJvb2tTcGVjTGlzdFxuICAgICAqIEByZXR1cm4ge0FycmF5PEJvb2tTcGVjaWZpY2F0aW9uPn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGJvb2tTcGVjTGlzdCgpOiBBcnJheTxCb29rU3BlY2lmaWNhdGlvbj4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm9va1NwZWNMaXN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBib29rU3BlY0xpc3RcbiAgICAgKiBAcGFyYW0ge0FycmF5PEJvb2tTcGVjaWZpY2F0aW9uPn0gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IGJvb2tTcGVjTGlzdCh2YWx1ZTogQXJyYXk8Qm9va1NwZWNpZmljYXRpb24+KSB7XG4gICAgICAgIHRoaXMuX2Jvb2tTcGVjTGlzdCA9IHZhbHVlO1xuICAgIH1cblxuXG4gICAgcHVibGljIGdldEJvb2soaXNibjogc3RyaW5nKTogQm9vayB7XG4gICAgICAgIC8vQnVyYWRhbiBudWxsIGJpciBkZcSfZXIgZGUgZMO2bmViaWxlY2XEn2kgacOnaW4gaGF0YSB2ZXJpeW9yXG4gICAgICAgIC8vYW1hIGJpeiBzb25kYWtpICEgb3BlcmF0w7Zyw7wgaWxlIG51bGwgZGXEn2VyIGTDtm5tZXllY2VrIGRpeWUgZ2FyYW50aSB2ZXJpeW9ydXpcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9va0xpc3QuZmluZChiID0+IGIuaXNibiA9PT0gaXNibikhO1xuICAgIH1cblxuICAgIHB1YmxpYyBhZGRCb29rKG5ld0Jvb2s6IEJvb2spIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuYm9va0xpc3QucHVzaChuZXdCb29rKTtcbiAgICAgICAgICAgIHRoaXMuX2Jvb2tTcGVjTGlzdC5wdXNoKG5ld0Jvb2suYm9va1NwZWMpO1xuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiS2l0YXAgZWtsZW5pcmtlbiBiaXIgaGF0YSBtZXlkYW5hIGdlbGRpLlwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBpc1ZhbGlkQm9vayhpc2JuOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgYiA9IHRoaXMuZ2V0Qm9vayhpc2JuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9va0xpc3QuaW5jbHVkZXMoYilcbiAgICB9XG5cbiAgICBhc3luYyBpbml0aWFsaXplRGF0YU1vY2soKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjMwMDIvYXBpL2Jvb2tzJywge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSGF0YSBvbHXFn3R1LCBoYXRhIGtvZHU6ICR7cmVzcG9uc2Uuc3RhdHVzfSBgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgICAgICAgY29uc3QgZ2V0UmVzdWx0ID0gPEJvb2tbXT5KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlc3VsdCwgbnVsbCwgNCkpO1xuICAgICAgICAgICAgdGhpcy5ib29rTGlzdCA9IGdldFJlc3VsdCBhcyBBcnJheTxCb29rPjtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5ib29rTGlzdCk7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGxpc3RCb29rcygpIHtcbiAgICAgICAgY29uc3QgbGlzdEJvb2tzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsaXN0Qm9va3NcIik7XG5cbiAgICAgICAgaWYgKGxpc3RCb29rc0Rpdikge1xuICAgICAgICAgICAgbGV0IHJvdywgY29sdW1uO1xuXG4gICAgICAgICAgICB3aGlsZSAobGlzdEJvb2tzRGl2Lmxhc3RDaGlsZCAmJiBsaXN0Qm9va3NEaXYuY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGxpc3RCb29rc0Rpdi5yZW1vdmVDaGlsZChsaXN0Qm9va3NEaXYubGFzdENoaWxkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5ib29rTGlzdC5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgICAgIHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9IFwicm93LWxpc3QtYm9va1wiO1xuXG4gICAgICAgICAgICAgICAgY29sdW1uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBjb2x1bW4uY2xhc3NOYW1lID0gXCJjb2x1bW4tbGlzdC1ib29rXCI7XG4gICAgICAgICAgICAgICAgY29sdW1uLnRleHRDb250ZW50ID0gZWxlbWVudC5pc2JuLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG5cbiAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIGNvbHVtbi5jbGFzc05hbWUgPSBcImNvbHVtbi1saXN0LWJvb2tcIjtcbiAgICAgICAgICAgICAgICBjb2x1bW4udGV4dENvbnRlbnQgPSBlbGVtZW50Lm5hbWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY29sdW1uKTtcblxuICAgICAgICAgICAgICAgIGNvbHVtbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgY29sdW1uLmNsYXNzTmFtZSA9IFwiY29sdW1uLWxpc3QtYm9va1wiO1xuICAgICAgICAgICAgICAgIGNvbHVtbi50ZXh0Q29udGVudCA9IGVsZW1lbnQuYXV0aG9yLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG5cbiAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIGNvbHVtbi5jbGFzc05hbWUgPSBcImNvbHVtbi1saXN0LWJvb2tcIjtcbiAgICAgICAgICAgICAgICBjb2x1bW4udGV4dENvbnRlbnQgPSBzdG9ja1NlcnZpY2UuZ2V0U3RvY2tRdWFudGl0eShlbGVtZW50LmlzYm4pLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG5cbiAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgIGNvbHVtbi5jbGFzc05hbWUgPSBcImNvbHVtbi1saXN0LWJvb2tcIjtcbiAgICAgICAgICAgICAgICBjb2x1bW4udGV4dENvbnRlbnQgPSBlbGVtZW50LmJvb2tTcGVjLnByaWNlLnRvU3RyaW5nKCkgKyBcIiDigrpcIjtcbiAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY29sdW1uKTtcblxuICAgICAgICAgICAgICAgIGxpc3RCb29rc0Rpdi5hcHBlbmRDaGlsZChyb3cpO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBhc3luYyBhZGRCb29rTW9jayhiOiBCb29rKTogUHJvbWlzZTxCb29sZWFuIHwgdW5kZWZpbmVkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuYm9va0FwaSwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgaXNibjogYi5pc2JuLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBiLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcjogYi5hdXRob3IsXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VzOiBiLnBhZ2VzLFxuICAgICAgICAgICAgICAgICAgICBwdWJsaXNoWWVhcjogYi5wdWJsaXNoWWVhclxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSAoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIYXRhIG9sdcWfdHUsIGhhdGEga29kdTogJHtyZXNwb25zZS5zdGF0dXN9IGApO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0hhdGEgT2x1xZ90dS4nKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgeyBEYXRhQmFzZSB9IGZyb20gXCIuLi9kYi9kYXRhYmFzZVwiO1xuaW1wb3J0IHsgQ2FuY2VsU2FsZSB9IGZyb20gXCIuLi9kb21haW4vY2FuY2FsLXNhbGVcIjtcblxuZXhwb3J0IGNsYXNzIENhbmNlbFNhbGVTZXJ2aWNlIHtcbiAgICBwcml2YXRlIF9jYW5jZWxsZWRTYWxlc0xpc3Q6IEFycmF5PENhbmNlbFNhbGU+O1xuICAgIGNhbmNlbFNhbGVBcGk6IHN0cmluZyA9ICdodHRwOi8vbG9jYWxob3N0OjMwMDIvYXBpL2NhbmNlbFNhbGUnO1xuXG4gICAgY29uc3RydWN0b3IoY2FuY2VsbGVkU2FsZXNMaXN0OiBBcnJheTxDYW5jZWxTYWxlPikge1xuICAgICAgICB0aGlzLl9jYW5jZWxsZWRTYWxlc0xpc3QgPSBjYW5jZWxsZWRTYWxlc0xpc3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0dGVyIGNhbmNlbGxlZFNhbGVzTGlzdFxuICAgICAqIEByZXR1cm4ge0FycmF5PENhbmNlbFNhbGU+fVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgY2FuY2VsbGVkU2FsZXNMaXN0KCk6IEFycmF5PENhbmNlbFNhbGU+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbmNlbGxlZFNhbGVzTGlzdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgY2FuY2VsbGVkU2FsZXNMaXN0XG4gICAgICogQHBhcmFtIHtBcnJheTxDYW5jZWxTYWxlPn0gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IGNhbmNlbGxlZFNhbGVzTGlzdCh2YWx1ZTogQXJyYXk8Q2FuY2VsU2FsZT4pIHtcbiAgICAgICAgdGhpcy5fY2FuY2VsbGVkU2FsZXNMaXN0ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIGNhbmNlbFNhbGUoY2FuY2VsU2FsZTogQ2FuY2VsU2FsZSk6IHZvaWQge1xuICAgICAgICBsZXQgcmVmdW5kOiBudW1iZXIgPSB0aGlzLmNhbGN1bGF0ZVJlZnVuZChjYW5jZWxTYWxlKTtcbiAgICAgICAgY2FuY2VsU2FsZS5yZWZ1bmQgPSByZWZ1bmQ7XG4gICAgICAgIHRoaXMuY2FuY2VsbGVkU2FsZXNMaXN0LnB1c2goY2FuY2VsU2FsZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGNhbGN1bGF0ZVJlZnVuZChjYW5jZWxTYWxlOiBDYW5jZWxTYWxlKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IGRpZmYgPSB0aGlzLmNhbGN1bGF0ZURpZmZIb3VycyhjYW5jZWxTYWxlLmNhbmNlbGVkRGF0ZVRpbWUsIGNhbmNlbFNhbGUuc2FsZS5vcGVyYXRpb25EYXRlVGltZSlcbiAgICAgICAgbGV0IHJlZnVuZDogbnVtYmVyO1xuXG4gICAgICAgIGlmIChkaWZmID4gMjQpIHtcbiAgICAgICAgICAgIHJlZnVuZCA9IGNhbmNlbFNhbGUuc2FsZS50b3RhbCAqIDAuNzU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWZ1bmQgPSBjYW5jZWxTYWxlLnNhbGUudG90YWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZnVuZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2FsY3VsYXRlRGlmZkhvdXJzKGQxOiBEYXRlLCBkMjogRGF0ZSk6IG51bWJlciB7XG5cbiAgICAgICAgbGV0IGRpZmZNaWxpczogbnVtYmVyID0gKGQxLmdldFRpbWUoKSAtIGQyLmdldFRpbWUoKSk7Ly8gbWlsaSBzZWNvbmRzXG4gICAgICAgIGxldCBkaWZmSG91ciA9IE1hdGguZmxvb3IoZGlmZk1pbGlzIC8gMTAwMCAvIDYwIC8gNjApOyAvLyAvMTAwMCA+IHNlY29uZCAvIDYwID4gbWluIC8gNjAgPiBob3VyXG4gICAgICAgIHJldHVybiBkaWZmSG91cjtcbiAgICB9XG5cbiAgICBhc3luYyBjYW5jZWxTYWxlTW9jayhjYW5jZWxTYWxlOiBDYW5jZWxTYWxlKTogUHJvbWlzZTxCb29sZWFuIHwgdW5kZWZpbmVkPiB7XG4gICAgICAgIGxldCByZWZ1bmQ6IG51bWJlciA9IHRoaXMuY2FsY3VsYXRlUmVmdW5kKGNhbmNlbFNhbGUpO1xuXG4gICAgICAgIGNhbmNlbFNhbGUucmVmdW5kID0gcmVmdW5kO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuY2FuY2VsU2FsZUFwaSwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgc2FsZTogY2FuY2VsU2FsZS5zYWxlLFxuICAgICAgICAgICAgICAgICAgICByZWZ1bmQ6IGNhbmNlbFNhbGUucmVmdW5kLFxuICAgICAgICAgICAgICAgICAgICBjYW5jZWxlZERhdGVUaW1lOiBjYW5jZWxTYWxlLmNhbmNlbGVkRGF0ZVRpbWVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy9Ub2RvIHNhbGUgbW9jayBzZXJ2aXNpbmUgZGVsZXRlIGlzdGXEn2kgYXTEsXAgbyBzYWxlIG5lc25lc2luaSBzaWxlY2VrXG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhhdGEgb2x1xZ90dSwgaGF0YSBrb2R1OiAke3Jlc3BvbnNlLnN0YXR1c30gYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgXG5cbiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSGF0YSBPbHXFn3R1LicpO1xuICAgICAgICB9XG5cblxuICAgIH1cblxuXG59IiwiaW1wb3J0IHsgRGF0YUJhc2UgfSBmcm9tIFwiLi4vZGIvZGF0YWJhc2VcIjtcbmltcG9ydCB7IEN1c3RvbWVyIH0gZnJvbSBcIi4uL2RvbWFpbi9jdXN0b21lclwiO1xuXG5leHBvcnQgY2xhc3MgQ3VzdG9tZXJTZXJ2aWNlIHtcbiAgICBwcml2YXRlIF9jdXN0b21lckxpc3Q6IEFycmF5PEN1c3RvbWVyPjtcbiAgICBwcml2YXRlIGN1c3RvbWVyQXBpOiBzdHJpbmcgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMi9hcGkvY3VzdG9tZXJzXCI7XG5cbiAgICBjb25zdHJ1Y3RvcihjdXN0b21lckxpc3Q6IEFycmF5PEN1c3RvbWVyPikge1xuICAgICAgICB0aGlzLl9jdXN0b21lckxpc3QgPSBjdXN0b21lckxpc3Q7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgY3VzdG9tZXJMaXN0XG4gICAgICogQHJldHVybiB7QXJyYXk8Q3VzdG9tZXI+fVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgY3VzdG9tZXJMaXN0KCk6IEFycmF5PEN1c3RvbWVyPiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXN0b21lckxpc3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIGN1c3RvbWVyTGlzdFxuICAgICAqIEBwYXJhbSB7QXJyYXk8Q3VzdG9tZXI+fSB2YWx1ZVxuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgY3VzdG9tZXJMaXN0KHZhbHVlOiBBcnJheTxDdXN0b21lcj4pIHtcbiAgICAgICAgdGhpcy5fY3VzdG9tZXJMaXN0ID0gdmFsdWU7XG4gICAgfVxuXG5cbiAgICBwdWJsaWMgYWRkQ3VzdG9tZXIobmV3Q3VzdG9tZXI6IEN1c3RvbWVyKSB7XG4gICAgICAgIHRoaXMuY3VzdG9tZXJMaXN0LnB1c2gobmV3Q3VzdG9tZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXROZXdDdXN0b21lcklkKCk6IG51bWJlciB7XG4gICAgICAgIGxldCBsYXN0Q3VzdG9tZXJJZDogbnVtYmVyID0gMDtcblxuICAgICAgICBpZiAodGhpcy5jdXN0b21lckxpc3QubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICBsYXN0Q3VzdG9tZXJJZCA9IHRoaXMuY3VzdG9tZXJMaXN0LmF0KHRoaXMuY3VzdG9tZXJMaXN0Lmxlbmd0aCAtIDEpIS5pZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxhc3RDdXN0b21lcklkID0gbGFzdEN1c3RvbWVySWQgKyAxO1xuXG4gICAgICAgIHJldHVybiBsYXN0Q3VzdG9tZXJJZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0Q3VzdG9tZXJJbmZvKGlkOiBudW1iZXIpOiBDdXN0b21lciB8IHVuZGVmaW5lZCB7XG5cbiAgICAgICAgbGV0IGN1c3RvbWVyID0gdGhpcy5jdXN0b21lckxpc3QuZmluZChjdXN0b21lciA9PiBjdXN0b21lci5pZCA9PT0gaWQpO1xuXG4gICAgICAgIGlmIChjdXN0b21lcikge1xuICAgICAgICAgICAgcmV0dXJuIGN1c3RvbWVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBpc1ZhbGlkQ3VzdG9tZXIoY3VzdG9tZXJJZDogbnVtYmVyKTogYm9vbGVhbiB7XG5cbiAgICAgICAgbGV0IGlzVmFsaWQgPSB0aGlzLmN1c3RvbWVyTGlzdC5zb21lKGN1c3RvbWVyID0+IGN1c3RvbWVyLmlkID09PSBjdXN0b21lcklkKTtcblxuICAgICAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBhZGRDdXN0b21lck1vY2sobmV3Q3VzdG9tZXI6IEN1c3RvbWVyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuY3VzdG9tZXJBcGksIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBuZXdDdXN0b21lci5pZCxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmV3Q3VzdG9tZXIubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc3VyTmFtZTogbmV3Q3VzdG9tZXIuc3VyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IG5ld0N1c3RvbWVyLnBob25lTnVtYmVyXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhhdGEgb2x1xZ90dSwgaGF0YSBrb2R1OiAke3Jlc3BvbnNlLnN0YXR1c30gYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdIYXRhIE9sdcWfdHUuJyk7XG4gICAgICAgIH1cbiAgICB9XG59IiwiaW1wb3J0IHsgc3RvY2tTZXJ2aWNlIH0gZnJvbSBcIi4uXCI7XG5pbXBvcnQgeyBEYXRhQmFzZSB9IGZyb20gXCIuLi9kYi9kYXRhYmFzZVwiO1xuaW1wb3J0IHsgQm9vayB9IGZyb20gXCIuLi9kb21haW4vYm9va1wiO1xuaW1wb3J0IHsgUmVudCB9IGZyb20gXCIuLi9kb21haW4vcmVudFwiO1xuaW1wb3J0IHsgUmVudENhcnQgfSBmcm9tIFwiLi4vZG9tYWluL3JlbnQtY2FydFwiO1xuaW1wb3J0IHsgU2FsZUNhcnQgfSBmcm9tIFwiLi4vZG9tYWluL3NhbGUtY2FydFwiO1xuXG5leHBvcnQgY2xhc3MgUmVudFNlcnZpY2Uge1xuICAgIHByaXZhdGUgX3JlbnRMaXN0OiBBcnJheTxSZW50PjtcblxuICAgIHByaXZhdGUgX3JlbnRDYXJ0OiBSZW50Q2FydDtcbiAgICBwdWJsaWMgcmVudEFwaSA9ICdodHRwOi8vbG9jYWxob3N0OjMwMDIvYXBpL3JlbnRzJztcbiAgICByZWZ1bmRQZXJjZW50OiBudW1iZXI7XG5cblxuICAgIGNvbnN0cnVjdG9yKHJlbnRMaXN0OiBBcnJheTxSZW50PiwgcmVudENhcnQ6IFJlbnRDYXJ0KSB7XG4gICAgICAgIHRoaXMuX3JlbnRMaXN0ID0gcmVudExpc3Q7XG4gICAgICAgIHRoaXMucmVmdW5kUGVyY2VudCA9IDAuNzU7XG4gICAgICAgIHRoaXMuX3JlbnRDYXJ0ID0gcmVudENhcnQ7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXR0ZXIgcmVudExpc3RcbiAgICAgKiBAcmV0dXJuIHtBcnJheTxSZW50Pn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHJlbnRMaXN0KCk6IEFycmF5PFJlbnQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlbnRMaXN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciByZW50TGlzdFxuICAgICAqIEBwYXJhbSB7QXJyYXk8UmVudD59IHZhbHVlXG4gICAgICovXG4gICAgcHVibGljIHNldCByZW50TGlzdCh2YWx1ZTogQXJyYXk8UmVudD4pIHtcbiAgICAgICAgdGhpcy5fcmVudExpc3QgPSB2YWx1ZTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEdldHRlciByZW50Q2FydFxuICAgICAqIEByZXR1cm4ge1JlbnRDYXJ0fVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgcmVudENhcnQoKTogUmVudENhcnQge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVudENhcnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIHJlbnRDYXJ0XG4gICAgICogQHBhcmFtIHtSZW50Q2FydH0gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IHJlbnRDYXJ0KHZhbHVlOiBSZW50Q2FydCkge1xuICAgICAgICB0aGlzLl9yZW50Q2FydCA9IHZhbHVlO1xuICAgIH1cblxuXG5cbiAgICBwdWJsaWMgYWRkUmVudChyZW50OiBSZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVudExpc3QucHVzaChyZW50KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2FsY3VsYXRlVG90YWwocmVudDogUmVudCk6IG51bWJlciB7XG5cbiAgICAgICAgbGV0IG1hcDogTWFwPEJvb2ssIG51bWJlcj4gPSByZW50LmJvb2tBbmRRdWFudGl0eU1hcDtcblxuICAgICAgICBsZXQgc3ViVG90YWw6IG51bWJlciA9IDA7XG5cbiAgICAgICAgLy9pdCBjYW4gYmUgPT4gbGV0IGVudHJ5IG9mIHJlbnQuYm9va0FuZFF1YW50aXR5TWFwLmVudHJpZXMoKVxuICAgICAgICBmb3IgKGxldCBlbnRyeSBvZiByZW50LmJvb2tBbmRRdWFudGl0eU1hcCkge1xuICAgICAgICAgICAgc3ViVG90YWwgKz0gZW50cnlbMF0uYm9va1NwZWMucHJpY2UgKiBlbnRyeVsxXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWJUb3RhbDtcbiAgICB9XG5cbiAgICAvLyBSMDUxMDIyMTQ1NTA5ID0+IGRvbWFpbi5SZW50IDA1LjEwLjIwMjIgMTQ6NTUuMDlcbiAgICBnZW5lcmF0ZVJlbnROdW1iZXIoY3VzdG9tZXJJZDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgICAgbGV0IHJlY2VpcHROdW1iZXI6IHN0cmluZyA9IFwiUlwiICsgdG9kYXkuZ2V0RGF5KCkudG9TdHJpbmcgKyB0b2RheS5nZXRNb250aCgpLnRvU3RyaW5nICsgdG9kYXkuZ2V0RnVsbFllYXIoKS50b1N0cmluZyArIHRvZGF5LmdldEhvdXJzKCkudG9TdHJpbmcgKyB0b2RheS5nZXRNaW51dGVzKCkudG9TdHJpbmcgKyB0b2RheS5nZXRTZWNvbmRzKCkudG9TdHJpbmcgKyBjdXN0b21lcklkLnRvU3RyaW5nO1xuXG4gICAgICAgIHJldHVybiByZWNlaXB0TnVtYmVyO1xuICAgIH1cblxuICAgIHB1YmxpYyBjYWxjdWxhdGVSZWZ1bmQocmVudDogUmVudCk6IHZvaWQge1xuICAgICAgICByZW50LnJlZnVuZCA9IHJlbnQudG90YWwgKiB0aGlzLnJlZnVuZFBlcmNlbnQ7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZEJvb2tUb0NhcnQoYm9vazogQm9vaywgcXVhbnRpdHk6IG51bWJlciwgY3VzdG9tZXJJZDogbnVtYmVyKSB7XG4gICAgICAgIGlmICh0aGlzLnJlbnRDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcC5zaXplID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnJlbnRDYXJ0LmN1c3RvbWVySWQgPSBjdXN0b21lcklkO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVudENhcnQuYm9va0FuZFF1YW50aXR5TWFwLnNpemUgPiAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZW50Q2FydC5jdXN0b21lcklkICE9PSBjdXN0b21lcklkKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJGYXJrbMSxIG3DvMWfdGVyaXllIGtpdGFwIGtpcmFsYW5tYXlhIMOnYWzEscWfxLFsxLF5b3IuIEzDvHRmZW4gdGVrIG3DvMWfdGVyaSBpw6dpbiBpxZ9sZW0geWFwxLFuxLF6XCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVudENhcnQuYm9va0FuZFF1YW50aXR5TWFwLnNldChib29rLCBxdWFudGl0eSk7XG4gICAgICAgIHRoaXMudXBkYXRlUmVudENhcnQoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlUmVudENhcnQoKSB7XG4gICAgICAgIGNvbnN0IHJlbnRDYXJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZW50Q2FydFwiKTtcbiAgICAgICAgY29uc3Qgc3ViVG90YWxTcGFuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3RhbFJlbnRBbW91bnRUbFwiKTtcblxuICAgICAgICBpZiAocmVudENhcnQpIHtcblxuICAgICAgICAgICAgbGV0IHJvdywgY29sdW1uLCBzdWJUb3RhbDogbnVtYmVyID0gMDtcblxuICAgICAgICAgICAgd2hpbGUgKHJlbnRDYXJ0Lmxhc3RDaGlsZCAmJiByZW50Q2FydC5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgcmVudENhcnQucmVtb3ZlQ2hpbGQocmVudENhcnQubGFzdENoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN1YlRvdGFsU3BhbiEudGV4dENvbnRlbnQgPSBcIlwiO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5yZW50Q2FydC5ib29rQW5kUXVhbnRpdHlNYXAuc2l6ZTsgaW5kZXgrKykge1xuXG4gICAgICAgICAgICAgICAgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICByb3cuY2xhc3NOYW1lID0gXCJyZW50LWNhcnQtcm93XCI7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBlbnRyeSBvZiB0aGlzLnJlbnRDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcC5lbnRyaWVzKCkpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4uY2xhc3NOYW1lID0gXCJyZW50LWNhcnQtY29sdW1uXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi50ZXh0Q29udGVudCA9IHRoaXMucmVudENhcnQuY3VzdG9tZXJJZC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY29sdW1uKTtcblxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4uY2xhc3NOYW1lID0gXCJyZW50LWNhcnQtY29sdW1uXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi50ZXh0Q29udGVudCA9IGVudHJ5WzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjb2x1bW4pO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi5jbGFzc05hbWUgPSBcInJlbnQtY2FydC1jb2x1bW5cIjtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLnRleHRDb250ZW50ID0gZW50cnlbMV0udG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG5cbiAgICAgICAgICAgICAgICAgICAgY29sdW1uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLmNsYXNzTmFtZSA9IFwicmVudC1jYXJ0LWNvbHVtblwiO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4udGV4dENvbnRlbnQgPSAoZW50cnlbMF0uYm9va1NwZWMucHJpY2UgKiBlbnRyeVsxXSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocm93ICYmIHN1YlRvdGFsU3Bhbikge1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgdCBvZiB0aGlzLnJlbnRDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJUb3RhbCArPSB0WzBdLmJvb2tTcGVjLnByaWNlICogdFsxXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZW50Q2FydC5hcHBlbmRDaGlsZChyb3cpO1xuICAgICAgICAgICAgICAgIHN1YlRvdGFsU3Bhbi50ZXh0Q29udGVudCA9IHN1YlRvdGFsLnRvU3RyaW5nKCkgKyBcIiBUTFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuXG4gICAgfVxuXG4gICAgcHVibGljIGNhcnRUb1JlbnQoKSB7XG4gICAgICAgIGxldCByZW50Q2FydDogUmVudENhcnQgPSB0aGlzLnJlbnRDYXJ0O1xuICAgICAgICBsZXQgcmVudCA9IG5ldyBSZW50KCk7XG5cbiAgICAgICAgcmVudC5ib29rQW5kUXVhbnRpdHlNYXAgPSByZW50Q2FydC5ib29rQW5kUXVhbnRpdHlNYXA7XG4gICAgICAgIHJlbnQuY3VzdG9tZXJJZCA9IHJlbnRDYXJ0LmN1c3RvbWVySWQ7XG4gICAgICAgIHJlbnQub3BlcmF0aW9uTnVtYmVyID0gdGhpcy5nZW5lcmF0ZVJlbnROdW1iZXIocmVudENhcnQuY3VzdG9tZXJJZCk7XG4gICAgICAgIHJlbnQub3BlcmF0aW9uRGF0ZVRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZW50LnRvdGFsID0gdGhpcy5jYWxjdWxhdGVUb3RhbChyZW50KTtcblxuICAgICAgICBmb3IgKGxldCBxIG9mIHJlbnQuYm9va0FuZFF1YW50aXR5TWFwKSB7XG4gICAgICAgICAgICBzdG9ja1NlcnZpY2UuaW5jcmVhc2VTdG9jayhxWzBdLmlzYm4sIC1xWzFdKVxuICAgICAgICB9XG5cblxuICAgICAgICB0aGlzLnJlbnRDYXJ0ID0gbmV3IFJlbnRDYXJ0OyAvLyBzZXBldGkgYm/Fn2FsdFxuICAgICAgICB0aGlzLnVwZGF0ZVJlbnRDYXJ0KCk7XG5cbiAgICAgICAgbGV0IHN1Y2Nlc3MgPSB0aGlzLmFkZFJlbnRNb2NrKHJlbnQpO1xuICAgIH1cblxuICAgIGFzeW5jIGFkZFJlbnRNb2NrKHI6IFJlbnQpOiBQcm9taXNlPEJvb2xlYW4gfCB1bmRlZmluZWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHIuYm9va0FuZFF1YW50aXR5TWFwKTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0aGlzLnJlbnRBcGksIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGJvb2tBbmRRdWFudGl0eTogci5ib29rQW5kUXVhbnRpdHlNYXAsXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbWVySWQ6IHIuY3VzdG9tZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uRGF0ZVRpbWU6IHIub3BlcmF0aW9uRGF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbk51bWJlcjogci5vcGVyYXRpb25OdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiByLnRvdGFsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgYWxlcnQocmVzdWx0Lm1lc3NhZ2UgKyBcIiBcIiArIHJlc3VsdC5zYWxlTnVtYmVyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIYXRhIG9sdcWfdHUsIGhhdGEga29kdTogJHtyZXNwb25zZS5zdGF0dXN9IGApO1xuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdIYXRhIE9sdcWfdHUuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufSIsImltcG9ydCB7IHN0b2NrU2VydmljZSB9IGZyb20gXCIuLlwiO1xuaW1wb3J0IHsgQm9vayB9IGZyb20gXCIuLi9kb21haW4vYm9va1wiO1xuaW1wb3J0IHsgU2FsZSB9IGZyb20gXCIuLi9kb21haW4vc2FsZVwiO1xuaW1wb3J0IHsgU2FsZUNhcnQgfSBmcm9tIFwiLi4vZG9tYWluL3NhbGUtY2FydFwiO1xuXG5leHBvcnQgY2xhc3MgU2FsZVNlcnZpY2Uge1xuICAgIHByaXZhdGUgX3NhbGVMaXN0OiBBcnJheTxTYWxlPjtcbiAgICBwcml2YXRlIF9zYWxlQ2FydDogU2FsZUNhcnQ7XG4gICAgcHVibGljIHNhbGVBcGkgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAyL2FwaS9zYWxlcyc7XG5cbiAgICBjb25zdHJ1Y3RvcihzYWxlTGlzdDogQXJyYXk8U2FsZT4sIHNhbGVDYXJ0OiBTYWxlQ2FydCkge1xuICAgICAgICB0aGlzLl9zYWxlTGlzdCA9IHNhbGVMaXN0O1xuICAgICAgICB0aGlzLl9zYWxlQ2FydCA9IHNhbGVDYXJ0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBzYWxlTGlzdFxuICAgICAqIEByZXR1cm4ge0FycmF5PFNhbGU+fVxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgc2FsZUxpc3QoKTogQXJyYXk8U2FsZT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2FsZUxpc3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0dGVyIHNhbGVMaXN0XG4gICAgICogQHBhcmFtIHtBcnJheTxTYWxlPn0gdmFsdWVcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0IHNhbGVMaXN0KHZhbHVlOiBBcnJheTxTYWxlPikge1xuICAgICAgICB0aGlzLl9zYWxlTGlzdCA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBzYWxlQ2FydFxuICAgICAqIEByZXR1cm4ge0FycmF5PFNhbGVDYXJ0Pn1cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHNhbGVDYXJ0KCk6IFNhbGVDYXJ0IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NhbGVDYXJ0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHRlciBzYWxlQ2FydFxuICAgICAqIEBwYXJhbSB7QXJyYXk8U2FsZUNhcnQ+fSB2YWx1ZVxuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgc2FsZUNhcnQodmFsdWU6IFNhbGVDYXJ0KSB7XG4gICAgICAgIHRoaXMuX3NhbGVDYXJ0ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZFNhbGUoc2FsZTogU2FsZSk6IHZvaWQge1xuICAgICAgICB0aGlzLnNhbGVMaXN0LnB1c2goc2FsZSk7XG5cbiAgICB9XG5cbiAgICBjYWxjdWxhdGVUb3RhbChzYWxlOiBTYWxlKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IHN1YlRvdGFsID0gMC4wO1xuXG4gICAgICAgIGZvciAobGV0IGVudHJ5IG9mIHNhbGUuYm9va0FuZFF1YW50aXR5TWFwLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgc3ViVG90YWwgKz0gZW50cnlbMF0uYm9va1NwZWMucHJpY2UgKiBlbnRyeVsxXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWJUb3RhbDtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZVNhbGVOdW1iZXIoY3VzdG9tZXJJZDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgICAgbGV0IHJlY2VpcHROdW1iZXI6IHN0cmluZyA9IFwiU1wiICsgdG9kYXkuZ2V0RGF5KCkudG9TdHJpbmcoKSArIHRvZGF5LmdldE1vbnRoKCkudG9TdHJpbmcoKSArIHRvZGF5LmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSArIHRvZGF5LmdldEhvdXJzKCkudG9TdHJpbmcoKSArIHRvZGF5LmdldE1pbnV0ZXMoKS50b1N0cmluZygpICsgdG9kYXkuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkgKyBjdXN0b21lcklkLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgcmV0dXJuIHJlY2VpcHROdW1iZXI7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFNhbGUoc2FsZU51bWJlcjogc3RyaW5nKTogU2FsZSB7XG4gICAgICAgIGxldCBzYWxlID0gdGhpcy5zYWxlTGlzdC5maW5kKHMgPT4gcy5vcGVyYXRpb25OdW1iZXIgPT09IHNhbGVOdW1iZXIpO1xuICAgICAgICByZXR1cm4gc2FsZSE7XG4gICAgfVxuXG4gICAgcHVibGljIHJlbW92ZVNhbGUoc2FsZTogU2FsZSkge1xuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnNhbGVMaXN0LmluZGV4T2Yoc2FsZSk7XG4gICAgICAgIHRoaXMuc2FsZUxpc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkQm9va1RvQ2FydChib29rOiBCb29rLCBxdWFudGl0eTogbnVtYmVyLCBjdXN0b21lcklkOiBudW1iZXIpIHtcblxuICAgICAgICBpZiAodGhpcy5zYWxlQ2FydC5ib29rQW5kUXVhbnRpdHlNYXAuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zYWxlQ2FydC5jdXN0b21lcklkID0gY3VzdG9tZXJJZDtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNhbGVDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcC5zaXplID4gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2FsZUNhcnQuY3VzdG9tZXJJZCAhPT0gY3VzdG9tZXJJZCkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiRmFya2zEsSBtw7zFn3Rlcml5ZSBraXRhcCBzYXTEsWxtYXlhIMOnYWzEscWfxLFsxLF5b3IuIEzDvHRmZW4gdGVrIG3DvMWfdGVyaSBpw6dpbiBpxZ9sZW0geWFwxLFuxLF6XCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2FsZUNhcnQuYm9va0FuZFF1YW50aXR5TWFwLnNldChib29rLCBxdWFudGl0eSk7XG4gICAgICAgIHRoaXMudXBkYXRlU2FsZUNhcnQoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlU2FsZUNhcnQoKSB7XG4gICAgICAgIGNvbnN0IHNhbGVDYXJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzYWxlQ2FydFwiKTtcbiAgICAgICAgY29uc3Qgc3ViVG90YWxTcGFuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b3RhbFNhbGVBbW91bnRUbFwiKTtcblxuICAgICAgICBpZiAoc2FsZUNhcnQpIHtcblxuICAgICAgICAgICAgbGV0IHJvdywgY29sdW1uLCBzdWJUb3RhbDogbnVtYmVyID0gMDtcblxuICAgICAgICAgICAgd2hpbGUgKHNhbGVDYXJ0Lmxhc3RDaGlsZCAmJiBzYWxlQ2FydC5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgc2FsZUNhcnQucmVtb3ZlQ2hpbGQoc2FsZUNhcnQubGFzdENoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN1YlRvdGFsU3BhbiEudGV4dENvbnRlbnQgPSBcIlwiO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5zYWxlQ2FydC5ib29rQW5kUXVhbnRpdHlNYXAuc2l6ZTsgaW5kZXgrKykge1xuXG4gICAgICAgICAgICAgICAgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICByb3cuY2xhc3NOYW1lID0gXCJzYWxlLWNhcnQtcm93XCI7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBlbnRyeSBvZiB0aGlzLnNhbGVDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcC5lbnRyaWVzKCkpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4uY2xhc3NOYW1lID0gXCJzYWxlLWNhcnQtY29sdW1uXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi50ZXh0Q29udGVudCA9IHRoaXMuc2FsZUNhcnQuY3VzdG9tZXJJZC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY29sdW1uKTtcblxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4uY2xhc3NOYW1lID0gXCJzYWxlLWNhcnQtY29sdW1uXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi50ZXh0Q29udGVudCA9IGVudHJ5WzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChjb2x1bW4pO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbi5jbGFzc05hbWUgPSBcInNhbGUtY2FydC1jb2x1bW5cIjtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLnRleHRDb250ZW50ID0gZW50cnlbMV0udG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG5cbiAgICAgICAgICAgICAgICAgICAgY29sdW1uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLmNsYXNzTmFtZSA9IFwic2FsZS1jYXJ0LWNvbHVtblwiO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW4udGV4dENvbnRlbnQgPSAoZW50cnlbMF0uYm9va1NwZWMucHJpY2UgKiBlbnRyeVsxXSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGNvbHVtbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocm93ICYmIHN1YlRvdGFsU3Bhbikge1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgdCBvZiB0aGlzLnNhbGVDYXJ0LmJvb2tBbmRRdWFudGl0eU1hcCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJUb3RhbCArPSB0WzBdLmJvb2tTcGVjLnByaWNlICogdFsxXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzYWxlQ2FydC5hcHBlbmRDaGlsZChyb3cpO1xuICAgICAgICAgICAgICAgIHN1YlRvdGFsU3Bhbi50ZXh0Q29udGVudCA9IHN1YlRvdGFsLnRvU3RyaW5nKCkgKyBcIiBUTFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNhcnRUb1NhbGUoKSB7XG4gICAgICAgIGxldCBzYWxlQ2FydDogU2FsZUNhcnQgPSB0aGlzLnNhbGVDYXJ0O1xuICAgICAgICBsZXQgc2FsZSA9IG5ldyBTYWxlKCk7XG5cbiAgICAgICAgc2FsZS5ib29rQW5kUXVhbnRpdHlNYXAgPSBzYWxlQ2FydC5ib29rQW5kUXVhbnRpdHlNYXA7XG4gICAgICAgIHNhbGUuY3VzdG9tZXJJZCA9IHNhbGVDYXJ0LmN1c3RvbWVySWQ7XG4gICAgICAgIHNhbGUub3BlcmF0aW9uTnVtYmVyID0gdGhpcy5nZW5lcmF0ZVNhbGVOdW1iZXIoc2FsZUNhcnQuY3VzdG9tZXJJZCk7XG4gICAgICAgIHNhbGUub3BlcmF0aW9uRGF0ZVRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBzYWxlLnRvdGFsID0gdGhpcy5jYWxjdWxhdGVUb3RhbChzYWxlKTtcblxuICAgICAgICBmb3IgKGxldCBxIG9mIHNhbGUuYm9va0FuZFF1YW50aXR5TWFwKSB7XG4gICAgICAgICAgICBzdG9ja1NlcnZpY2UuaW5jcmVhc2VTdG9jayhxWzBdLmlzYm4sIC1xWzFdKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hZGRTYWxlTW9jayhzYWxlKTtcbiAgICAgICAgdGhpcy5zYWxlQ2FydCA9IG5ldyBTYWxlQ2FydDsgLy8gc2VwZXRpIGJvxZ9hbHRcbiAgICAgICAgdGhpcy51cGRhdGVTYWxlQ2FydCgpO1xuICAgIH1cblxuICAgIGFzeW5jIGFkZFNhbGVNb2NrKHM6IFNhbGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHMuYm9va0FuZFF1YW50aXR5TWFwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0aGlzLnNhbGVBcGksIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGJvb2tBbmRRdWFudGl0eTogcy5ib29rQW5kUXVhbnRpdHlNYXAsXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbWVySWQ6IHMuY3VzdG9tZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uRGF0ZVRpbWU6IHMub3BlcmF0aW9uRGF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbk51bWJlcjogcy5vcGVyYXRpb25OdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiBzLnRvdGFsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhhdGEgb2x1xZ90dSwgaGF0YSBrb2R1OiAke3Jlc3BvbnNlLnN0YXR1c30gYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYWxlcnQocmVzdWx0Lm1lc3NhZ2UgKyBcIiBcIisgcmVzdWx0LnNhbGVOdW1iZXIpO1xuXG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0hhdGEgT2x1xZ90dS4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbiIsImltcG9ydCB7IERhdGFCYXNlIH0gZnJvbSBcIi4uL2RiL2RhdGFiYXNlXCI7XG5pbXBvcnQgeyBTdG9jayB9IGZyb20gXCIuLi9kb21haW4vc3RvY2tcIjtcblxuZXhwb3J0IGNsYXNzIFN0b2NrU2VydmljZSB7XG4gICAgcHJpdmF0ZSBfc3RvY2tMaXN0OiBBcnJheTxTdG9jaz47XG4gICAgcHJpdmF0ZSBzdG9ja0FwaTogc3RyaW5nID0gXCJodHRwOi8vbG9jYWxob3N0OjMwMDIvYXBpL3N0b2Nrc1wiO1xuXG4gICAgY29uc3RydWN0b3Ioc3RvY2tMaXN0OiBBcnJheTxTdG9jaz4pIHtcbiAgICAgICAgdGhpcy5fc3RvY2tMaXN0ID0gc3RvY2tMaXN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHRlciBzdG9ja0xpc3RcbiAgICAgKiBAcmV0dXJuIHtBcnJheTxTdG9jaz59XG4gICAgICovXG4gICAgcHVibGljIGdldCBzdG9ja0xpc3QoKTogQXJyYXk8U3RvY2s+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0b2NrTGlzdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXR0ZXIgc3RvY2tMaXN0XG4gICAgICogQHBhcmFtIHtBcnJheTxTdG9jaz59IHZhbHVlXG4gICAgICovXG4gICAgcHVibGljIHNldCBzdG9ja0xpc3QodmFsdWU6IEFycmF5PFN0b2NrPikge1xuICAgICAgICB0aGlzLl9zdG9ja0xpc3QgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLaXRhcCBoZW7DvHogZWtsZW5kaWt0ZW4gc29ucmEgaGVtZW4gZ2lyaXlvcixcbiAgICAgKiBFbGltaXpkZSBoacOnIHN0b2NrIGtheWTEsS9uZXNuZXNpIHlvaywgeWVuaSBrYXnEsXQvbmVzbmUgb2x1xZ90dXJ1eW9ydXpcbiAgICAgKiBZZW5pIGVrbGVuZW4ga2l0YWJhIHN0b2sgZWtsZW1lIGnFn2xlbWlcbiAgICAgKiBAcGFyYW0gaXNibiAgc3RvayBla2xlbmVjZWsgb2xhbiBraXRhYsSxbiBpc2JuIG51bWFyYXPEsVxuICAgICAqIEBwYXJhbSBzaGVsZk51bWJlciBzdG9rIGVrbGVuZWNlayBvbGFuIGtpdGFixLFuIHJhZiBudW1hcmFzxLFcbiAgICAgKiBAcGFyYW0gcXVhbnRpdHkga2l0YXBkYW4ga2HDpyBhZGV0IHN0b8SfYSBla2xlbmVjZWtcbiAgICAgKi9cbiAgICBwdWJsaWMgYWRkU3RvY2soaXNibjogc3RyaW5nLCBzaGVsZk51bWJlcjogc3RyaW5nLCBxdWFudGl0eTogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIGxldCBuZXdTdG9jayA9IG5ldyBTdG9jayhpc2JuLCBxdWFudGl0eSwgc2hlbGZOdW1iZXIpO1xuICAgICAgICAgICAgdGhpcy5zdG9ja0xpc3QucHVzaChuZXdTdG9jayk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogS2l0YXAgemF0ZW4gZWtsaSwgaGFsaWhhesSxcmRhIHZhciwgZGFoYSBzb25yYSB5ZW5pIGtpdGFwbGFyIGdlbGRpLHN0b2sgYXJ0xLFybWEgacWfbGVtaSxcbiAgICAgKiBAcGFyYW0gaXNibiBzdG9rIGVrbGVuZWNlayBvbGFuIGtpdGFixLFuIGlzYm4gbnVtYXJhc8SxXG4gICAgICogQHBhcmFtIHF1YW50aXR5IHN0b2sgZWtsZW5lY2VrIG9sYW4ga2l0YWLEsW4gYWRlZGlcbiAgICAgKiBAcmV0dXJucyBpxZ9sZW0gZ2Vyw6dla2xlxZ9tZXNpIGR1cnVtdW5kYSB0cnVlLCBkacSfZXIgZHVydW1kYSBmYWxzZSBkw7ZuZXJcbiAgICAgKi9cbiAgICBwdWJsaWMgaW5jcmVhc2VTdG9jayhpc2JuOiBzdHJpbmcsIHF1YW50aXR5OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHN0b2NrID0gdGhpcy5nZXRTdG9jayhpc2JuKTtcbiAgICAgICAgaWYgKHN0b2NrKSB7XG4gICAgICAgICAgICBzdG9jay5xdWFudGl0eSA9IChzdG9jay5xdWFudGl0eSArIHF1YW50aXR5KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc3RvY2sgbmVzbmVzaW5pIGdlcmkgZMO2bmTDvHLDvHJcbiAgICAgKiBAcGFyYW0gaXNibiBzdG9jayBuZXNuZXNpIGdldGlyaWxlY2VrIG9sYW4gbmVzbmVuaW4gaXNibiBub3N1LFxuICAgICAqIEByZXR1cm5zIGRiIG9sYW4gc3RvY2sgbmVzbmVuc2kgZ2VyaSBkw7ZuZXIsIGRiIGRlIHlvayBpc2UgdGhyb3cgaWxlIGhhdGEgZsSxcmxhdMSxcmzEsXJcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U3RvY2soaXNibjogc3RyaW5nKSB7XG4gICAgICAgIGxldCBzdG9jayA9IHRoaXMuc3RvY2tMaXN0LmZpbmQocyA9PiBzLmlzYm4gPT09IGlzYm4pO1xuICAgICAgICBpZiAoc3RvY2spIHtcbiAgICAgICAgICAgIHJldHVybiBzdG9jaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRTdG9ja1F1YW50aXR5KGlzYm46IHN0cmluZyk6IG51bWJlciB7XG4gICAgICAgIGxldCBzOiBTdG9jayA9IHRoaXMuZ2V0U3RvY2soaXNibikhO1xuXG4gICAgICAgIGlmIChzKSB7XG4gICAgICAgICAgICByZXR1cm4gcy5xdWFudGl0eTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRcSfZXIgc3RvayBuZXNuZXNpIHlvayBpc2Ugc3RvayBuZXNuZXNpLCBiZWxpcnRpbGVuIGFkZXQga2FkYXIgc3RvayBiaWxnaXNpIGlsZSBiZXJhYmVyIGVrbGVuaXlvci5cbiAgICAgKiDEsMWfdGUgYnUgb2x1xZ90dXJtYS9jcmVhdGUgacWfbGVtaSBidXJhZGEgeWFwxLFsxLF5b3IuXG4gICAgICogQHBhcmFtIHMgaW5kZXgudHMgZG9zeWFzxLFuZGFuIGdlbGVuIHN0b2sgbmVzbmVzaVxuICAgICAqL1xuICAgIGFzeW5jIGFkZFN0b2NrTW9jayhzOiBTdG9jayk6IFByb21pc2U8Qm9vbGVhbiB8IHVuZGVmaW5lZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0aGlzLnN0b2NrQXBpLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBpc2JuOiBzLmlzYm4sXG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBzLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgICAgICBzaGVsZk51bWJlcjogcy5zaGVsZk51bWJlclxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSAoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhhdGEgb2x1xZ90dSwgaGF0YSBrb2R1OiAke3Jlc3BvbnNlLnN0YXR1c30gYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSGF0YSBPbHXFn3R1LicgKyBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9rIGVrbGVuaXJrZW4gZcSfZXIgc3RvayBuZXNuZXNpIGRhaGEgw7ZuY2VkZW4gdmFyIGlzZSwgc3RvayBhcnTEsXLEsW3EsW7EsSBwdXQgaWxlIHlhcGFjYcSfxLF6XG4gICAgICogQHBhcmFtIHMgaW5kZXgudHMgZG9zeWFzxLFuZGFuIGdlbGVuIHN0b2sgbmVzbmVzaVxuICAgICAqL1xuICAgIGFzeW5jIGluY3JlYXNlU3RvY2tNb2NrKHM6IFN0b2NrKSB7XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5zdG9ja0FwaSArIFwiL1wiICsgcy5pc2JuLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGlzYm46IHMuaXNibixcbiAgICAgICAgICAgICAgICAgICAgcXVhbnRpdHk6IHMucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgICAgIHNoZWxmTnVtYmVyOiBzLnNoZWxmTnVtYmVyXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhhdGEgb2x1xZ90dSwgaGF0YSBrb2R1OiAke3Jlc3BvbnNlLnN0YXR1c30gYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0hhdGEgT2x1xZ90dS4nKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwNyk7XG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJ0aGlzIiwiX2Jvb2tzIiwiQXJyYXkiLCJfc3RvY2tzIiwiX2N1c3RvbWVycyIsIl9zYWxlcyIsIl9yZW50cyIsIl9ib29rU3BlY2lmaWNhdGlvbnMiLCJfY2FuY2VsU2FsZXMiLCJfc2FsZUNhcnQiLCJTYWxlQ2FydCIsIl9yZW50Q2FydCIsIlJlbnRDYXJ0IiwiZ2V0Qm9va3NMaXN0IiwiZ2V0U3RvY2tzTGlzdCIsImdldEN1c3RvbWVyc0xpc3QiLCJnZXRTYWxlc0xpc3QiLCJnZXRSZW50cyIsImdldEJvb2tTcGVjaWZpY2F0aW9ucyIsImdldENhbmNhbGVkU2FsZXMiLCJnZXRTYWxlQ2FydCIsImdldFJlbnRDYXJ0Iiwic2V0U2FsZUNhcnQiLCJ2YWx1ZSIsInNldFJlbnRDYXJ0IiwiaXNibiIsInByaWNlIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsIl9pc2JuIiwiX3ByaWNlIiwiX3N0YXJ0RGF0ZSIsIl9lbmREYXRlIiwibmFtZSIsImF1dGhvciIsInB1Ymxpc2hZZWFyIiwicGFnZXMiLCJib29rU3BlYyIsIl9uYW1lIiwiX2F1dGhvciIsIl9wdWJsaXNoWWVhciIsIl9wYWdlcyIsIl9ib29rU3BlYyIsInNhbGUiLCJyZWZ1bmQiLCJjYW5jZWxlZERhdGVUaW1lIiwiX3NhbGUiLCJfcmVmdW5kIiwiX2NhbmNlbGVkRGF0ZVRpbWUiLCJpZCIsInN1ck5hbWUiLCJwaG9uZU51bWJlciIsIl9pZCIsIl9zdXJOYW1lIiwiX3Bob25lTnVtYmVyIiwiYm9va0FuZFF1YW50aXR5TWFwIiwiTWFwIiwiUmVudCIsIlNhbGUiLCJvcGVyYXRpb25EYXRlVGltZSIsImN1c3RvbWVySWQiLCJvcGVyYXRpb25OdW1iZXIiLCJ0b3RhbCIsInJlZnVuZERhdGUiLCJzdXBlciIsIl9yZWZ1bmREYXRlIiwiX2Jvb2tBbmRRdWFudGl0eU1hcCIsIl9vcGVyYXRpb25EYXRlVGltZSIsIl9jdXN0b21lcklkIiwiX29wZXJhdGlvbk51bWJlciIsIl90b3RhbCIsInF1YW50aXR5Iiwic2hlbGZOdW1iZXIiLCJfcXVhbnRpdHkiLCJfc2hlbGZOdW1iZXIiLCJzaG93QW5kSGlkZSIsImJ0bklkIiwiZWxlbWVudElkIiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJidG4iLCJhZGRFdmVudExpc3RlbmVyIiwic3R5bGUiLCJkaXNwbGF5IiwiZGIiLCJEYXRhQmFzZSIsImJvb2tTZXJ2aWNlIiwiQm9va1NlcnZpY2UiLCJjdXN0b21lclNlcnZpY2UiLCJDdXN0b21lclNlcnZpY2UiLCJjYW5jZWxTYWxlU2VydmljZSIsIkNhbmNlbFNhbGVTZXJ2aWNlIiwicmVudFNlcnZpY2UiLCJSZW50U2VydmljZSIsInNhbGVTZXJ2aWNlIiwiU2FsZVNlcnZpY2UiLCJzdG9ja1NlcnZpY2UiLCJTdG9ja1NlcnZpY2UiLCJjb25zb2xlIiwibG9nIiwiYWRkQ3VzdG9tZXIiLCJDdXN0b21lciIsImFkZFN0b2NrIiwiaW5pdGlhbGl6ZURhdGFNb2NrIiwiaW5pdGlsaWF6ZURhdGEiLCJhZGRCb29rRm9ybSIsIm9uc3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInRpdGxlIiwiZ2V0IiwiRGF0ZSIsIkJvb2tTcGVjaWZpY2F0aW9uIiwiYm9vayIsIkJvb2siLCJhZGRCb29rTW9jayIsImFsZXJ0IiwicmVzZXQiLCJhZGRTdG9ja0Zvcm0iLCJxdWFudHRpeSIsInN0b2NrIiwiU3RvY2siLCJib29rTGlzdCIsInNvbWUiLCJiIiwiYWRkU3RvY2tNb2NrIiwiYWRkQ3VzdG9tZXJGb3JtIiwic3VybmFtZSIsImN1c3RvbWVyIiwiZ2V0TmV3Q3VzdG9tZXJJZCIsImFkZEN1c3RvbWVyTW9jayIsInNhbGVCb29rRm9ybSIsImdldEJvb2siLCJwYXJzZUludCIsImlzVmFsaWRDdXN0b21lciIsImdldFN0b2NrIiwiYWRkQm9va1RvQ2FydCIsImVycm9yIiwic2FsZUNhcnQiLCJzaXplIiwiY2FydFRvU2FsZSIsImxpc3RCb29rcyIsImNhbmNlbFNhbGVGb3JtIiwiYnEiLCJzZXQiLCJhIiwic2FsZUxpc3QiLCJwdXNoIiwic2FsZU51bWJlciIsImdldFNhbGUiLCJjYW5jZWxTYWxlIiwiQ2FuY2VsU2FsZSIsImNhbmNlbFNhbGVNb2NrIiwicmVudEJvb2tGb3JtIiwicmVudENhcnQiLCJjYXJ0VG9SZW50IiwiYm9va1NwZWNMaXN0IiwiYm9va0FwaSIsIl9ib29rTGlzdCIsIl9ib29rU3BlY0xpc3QiLCJmaW5kIiwiYWRkQm9vayIsIm5ld0Jvb2siLCJFeGNlcHRpb24iLCJpc1ZhbGlkQm9vayIsImluY2x1ZGVzIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJBY2NlcHQiLCJvayIsIkVycm9yIiwic3RhdHVzIiwicmVzdWx0IiwianNvbiIsImdldFJlc3VsdCIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsImxpc3RCb29rc0RpdiIsInJvdyIsImNvbHVtbiIsImxhc3RDaGlsZCIsImNoaWxkcmVuIiwibGVuZ3RoIiwicmVtb3ZlQ2hpbGQiLCJmb3JFYWNoIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInRleHRDb250ZW50IiwidG9TdHJpbmciLCJhcHBlbmRDaGlsZCIsImdldFN0b2NrUXVhbnRpdHkiLCJib2R5IiwiY2FuY2VsbGVkU2FsZXNMaXN0IiwiY2FuY2VsU2FsZUFwaSIsIl9jYW5jZWxsZWRTYWxlc0xpc3QiLCJjYWxjdWxhdGVSZWZ1bmQiLCJjYWxjdWxhdGVEaWZmSG91cnMiLCJkMSIsImQyIiwiZGlmZk1pbGlzIiwiZ2V0VGltZSIsIk1hdGgiLCJmbG9vciIsImN1c3RvbWVyTGlzdCIsImN1c3RvbWVyQXBpIiwiX2N1c3RvbWVyTGlzdCIsIm5ld0N1c3RvbWVyIiwibGFzdEN1c3RvbWVySWQiLCJhdCIsImdldEN1c3RvbWVySW5mbyIsInJlbnRMaXN0IiwicmVudEFwaSIsIl9yZW50TGlzdCIsInJlZnVuZFBlcmNlbnQiLCJhZGRSZW50IiwicmVudCIsImNhbGN1bGF0ZVRvdGFsIiwic3ViVG90YWwiLCJlbnRyeSIsImdlbmVyYXRlUmVudE51bWJlciIsInRvZGF5IiwiZ2V0RGF5IiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJ1cGRhdGVSZW50Q2FydCIsInN1YlRvdGFsU3BhbiIsImluZGV4IiwiZW50cmllcyIsInQiLCJxIiwiaW5jcmVhc2VTdG9jayIsImFkZFJlbnRNb2NrIiwiciIsImJvb2tBbmRRdWFudGl0eSIsIm1lc3NhZ2UiLCJzYWxlQXBpIiwiX3NhbGVMaXN0IiwiYWRkU2FsZSIsImdlbmVyYXRlU2FsZU51bWJlciIsInMiLCJyZW1vdmVTYWxlIiwiaW5kZXhPZiIsInNwbGljZSIsInVwZGF0ZVNhbGVDYXJ0IiwiYWRkU2FsZU1vY2siLCJzdG9ja0xpc3QiLCJzdG9ja0FwaSIsIl9zdG9ja0xpc3QiLCJuZXdTdG9jayIsImluY3JlYXNlU3RvY2tNb2NrIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIl0sInNvdXJjZVJvb3QiOiIifQ==